[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.7.8","content-config-digest","8c6ac08f1137ffab","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"site\":\"https://valerock.com\",\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[]},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":false,\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[null,[null,{}]],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"responsiveImages\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false},\"legacy\":{\"collections\":false}}","blog",["Map",11,12,43,44,72,73,115,116,158,159,184,185],"about-business-partnerships",{"id":11,"data":13,"body":25,"filePath":26,"digest":27,"rendered":28,"legacyId":42},{"title":14,"description":15,"pubDate":16,"updatedDate":17,"featured":18,"draft":18,"tags":19,"author":22},"About business partnerships","A personal reflection on the challenges of choosing a business partner, the evolution of BIBB, and a cofounder’s departure. While considering the future of BIBB, the immediate focus shifts to an upcoming presentation at the Association of Proposal Management Professionals.",["Date","2025-01-30T23:00:00.000Z"],["Date","2025-02-04T23:00:00.000Z"],false,[20,21],"Diary","Entrepreneurship",{"name":23,"link":24},"Oscar Martinez","https://example.com/authors/oscar-martinez","# About business partnerships\n\nAfter two failed businesses and one ([BIBB](https://www.bibb.pro/)) that has yet to fully find its shape, I’ve come to believe that among the many challenges of building a venture, choosing the right business partner is the hardest step. It’s not just about skillsets—it’s also about trust, direction, and personal alignment. \n\nI write this as Diana, my cofounder and business partner at BIBB, has decided to step away to focus on herself and other projects. Her decision hurt, but I understand her reasons. She needs to follow her own path, and no one can argue. \n\nDiana brought the UX to *UX Driven BI*: her expertise guided BIBB’s evolution from an online store to a platform for uploading CVs and eventually to a blog showcasing one of the [most popular tools for Power BI](https://powerbithemegenerator.bibb.pro/). \n\nShe also created the visual identity and cohesive style that BIBB users experience—something I will always appreciate. Her commitment to user-friendly, ethical design means our site has no dark patterns or intrusive advertisements, giving it a distinct, polished feel. Her contributions were essential to the journey.\n\nI’m truly grateful she chose to be part of BIBB for these years, and I wish her every success in whatever she decides to do next. \n\nFor now, I’m reflecting on whether to keep going solo or seek a new partner. I won’t rush that decision, though. My immediate focus is on preparing for a presentation at the [Association of Proposal Management Professionals](https://www.apmp.org/). \n\nThere’s a lot to do on that front, and I want to give it my full attention before making any major changes at BIBB.","src/content/blog/about-business-partnerships.md","af9156bac4f46c31",{"html":29,"metadata":30},"\u003Ch1 id=\"about-business-partnerships\">About business partnerships\u003C/h1>\n\u003Cp>After two failed businesses and one (\u003Ca href=\"https://www.bibb.pro/\">BIBB\u003C/a>) that has yet to fully find its shape, I’ve come to believe that among the many challenges of building a venture, choosing the right business partner is the hardest step. It’s not just about skillsets—it’s also about trust, direction, and personal alignment.\u003C/p>\n\u003Cp>I write this as Diana, my cofounder and business partner at BIBB, has decided to step away to focus on herself and other projects. Her decision hurt, but I understand her reasons. She needs to follow her own path, and no one can argue.\u003C/p>\n\u003Cp>Diana brought the UX to \u003Cem>UX Driven BI\u003C/em>: her expertise guided BIBB’s evolution from an online store to a platform for uploading CVs and eventually to a blog showcasing one of the \u003Ca href=\"https://powerbithemegenerator.bibb.pro/\">most popular tools for Power BI\u003C/a>.\u003C/p>\n\u003Cp>She also created the visual identity and cohesive style that BIBB users experience—something I will always appreciate. Her commitment to user-friendly, ethical design means our site has no dark patterns or intrusive advertisements, giving it a distinct, polished feel. Her contributions were essential to the journey.\u003C/p>\n\u003Cp>I’m truly grateful she chose to be part of BIBB for these years, and I wish her every success in whatever she decides to do next.\u003C/p>\n\u003Cp>For now, I’m reflecting on whether to keep going solo or seek a new partner. I won’t rush that decision, though. My immediate focus is on preparing for a presentation at the \u003Ca href=\"https://www.apmp.org/\">Association of Proposal Management Professionals\u003C/a>.\u003C/p>\n\u003Cp>There’s a lot to do on that front, and I want to give it my full attention before making any major changes at BIBB.\u003C/p>",{"headings":31,"localImagePaths":34,"remoteImagePaths":35,"frontmatter":36,"imagePaths":41},[32],{"depth":33,"slug":11,"text":14},1,[],[],{"title":14,"description":15,"pubDate":37,"updatedDate":38,"slug":11,"featured":18,"draft":18,"tags":39,"author":40},["Date","2025-01-30T23:00:00.000Z"],["Date","2025-02-04T23:00:00.000Z"],[20,21],{"name":23,"link":24},[],"about-business-partnerships.md","about-hiring-freelancers",{"id":43,"data":45,"body":55,"filePath":56,"digest":57,"rendered":58,"legacyId":71},{"title":46,"description":47,"pubDate":48,"updatedDate":49,"featured":18,"draft":18,"tags":50,"author":52},"About hiring freelancers","With over $7K spent on freelancers, key lessons emerge: discover hidden talent, avoid open-ended hourly contracts, and build trust with clear boundaries.",["Date","2025-02-06T00:00:00.000Z"],["Date","2025-02-06T00:00:00.000Z"],[20,51],"Entrepreneurships",{"name":53,"link":54},"Oscar","https://example.com/authors/oscar","# About hiring freelancers\n\nA routine content update became a deployment nightmare when GitHub deprecated a critical artifact on which I depended. Every push triggered failures, leaving my website stuck in limbo.\n\nAfter hours of troubleshooting with no success, I decided to take a step back and do what I’ve done many times before: turn to Upwork, my go-to platform for hiring freelancers. Within a few hours, an expert diagnosed and fixed the issue, all without me lifting a finger.\n\nThis wasn’t my first time outsourcing a technical challenge, and after spending over $7K on freelance talent, I’ve learned a lot—sometimes the hard way—about hiring the right people. Here are my biggest takeaways:\n\n1. **Be open to discovering hidden talent.** It is relatively easy to discover hidden talent. Every freelancer starts with zero reviews, which makes it tough to compete with experienced pros. This can be a great opportunity to find skilled newcomers who charge low rates to build their reputation, but it also comes with the risk of sour experiences. \n\n3. **Avoid hiring unknown freelancers on open-ended hourly contracts.** Such agreements require a higher level of trust and commitment from both parties, which should be built over time through smaller fix price projects first.\n\n5. **Learn trust, with boundaries.** Giving freelancers access to systems, access tokens, or prototypes is sometimes necessary, but it should be done carefully. Use temporary credentials, limit permissions, and revoke access when the job is done. Trust grows through time, good communication, and reliability. Over time, a freelancer on the other side of the world can become just as dependable as someone in the same office.","src/content/blog/about-hiring-freelancers.md","1eff2e60c9904c9f",{"html":59,"metadata":60},"\u003Ch1 id=\"about-hiring-freelancers\">About hiring freelancers\u003C/h1>\n\u003Cp>A routine content update became a deployment nightmare when GitHub deprecated a critical artifact on which I depended. Every push triggered failures, leaving my website stuck in limbo.\u003C/p>\n\u003Cp>After hours of troubleshooting with no success, I decided to take a step back and do what I’ve done many times before: turn to Upwork, my go-to platform for hiring freelancers. Within a few hours, an expert diagnosed and fixed the issue, all without me lifting a finger.\u003C/p>\n\u003Cp>This wasn’t my first time outsourcing a technical challenge, and after spending over $7K on freelance talent, I’ve learned a lot—sometimes the hard way—about hiring the right people. Here are my biggest takeaways:\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Be open to discovering hidden talent.\u003C/strong> It is relatively easy to discover hidden talent. Every freelancer starts with zero reviews, which makes it tough to compete with experienced pros. This can be a great opportunity to find skilled newcomers who charge low rates to build their reputation, but it also comes with the risk of sour experiences.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Avoid hiring unknown freelancers on open-ended hourly contracts.\u003C/strong> Such agreements require a higher level of trust and commitment from both parties, which should be built over time through smaller fix price projects first.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Learn trust, with boundaries.\u003C/strong> Giving freelancers access to systems, access tokens, or prototypes is sometimes necessary, but it should be done carefully. Use temporary credentials, limit permissions, and revoke access when the job is done. Trust grows through time, good communication, and reliability. Over time, a freelancer on the other side of the world can become just as dependable as someone in the same office.\u003C/p>\n\u003C/li>\n\u003C/ol>",{"headings":61,"localImagePaths":63,"remoteImagePaths":64,"frontmatter":65,"imagePaths":70},[62],{"depth":33,"slug":43,"text":46},[],[],{"title":46,"description":47,"pubDate":66,"updatedDate":67,"slug":43,"featured":18,"draft":18,"tags":68,"author":69},["Date","2025-02-06T00:00:00.000Z"],["Date","2025-02-06T00:00:00.000Z"],[20,51],{"name":53,"link":54},[],"about-hiring-freelancers.md","transforming-linkedins-approximate-posting-date-to-the-exact-date-and-time",{"id":72,"data":74,"body":82,"filePath":83,"digest":84,"rendered":85,"legacyId":114},{"title":75,"description":76,"pubDate":77,"featured":18,"draft":18,"tags":78,"author":81},"Transforming LinkedIn’s Approximate Posting Date to the Exact Date and Time","Learn how Pinpoint the Exact Posting Date from LinkedIn Activity Numbers Even When You Only See ‘1w’ or ‘3d’",["Date","2024-06-02T00:00:00.000Z"],[79,80],"LinkedIn","Python",{"name":53,"link":54},"# Transforming LinkedIn’s Approximate Posting Date to the Exact Date and Time\n\n## Discover How to Pinpoint the Exact Posting Date from LinkedIn Activity Numbers Even When You Only See ‘1w’ or ‘3d’.\n\n\nExamining a LinkedIn post’s HTML source shows a long numeric value tied to each activity. This number can be transformed to reveal the exact posting date from LinkedIn. Here’s how you can decode it.\n\nThe Original Activity Number\nLet’s start with an example activity number you might find in the HTML code of a LinkedIn post:\n\n![Getting activity number](https://hackmd.io/_uploads/S1hH-S5Dke.png)\n\n\n`7198200780061900800`\n\nThis number is more than just a random value; it actually encodes the exact posting date from LinkedIn in a form that can be decoded.\n\n### Step-by-Step Transformation\n**1. Convert to Binary**\n\nFirst, we need to convert this number to its binary form. In Python, this can be done using the bin() function:\n\n``` python\nactivity = 7198200780061900800\nbinary_activity = bin(activity)[2:]  # Remove the '0b' prefix\n```\n\nThe binary representation looks like this:\n\n`110001111100101001001010111100011000101100001111000000000000000`\n\n**2. Extract the First 41 Digits**\n\nNext, we extract the first 41 digits from this binary string. These digits are crucial as they encode the Unix timestamp in milliseconds.\n\nfirst_41_digits = binary_activity[:41]\nThe first 41 binary digits are:\n\n`11000111110010100100101011110001100010110`\n\n**3. Convert Binary to Decimal**\n\nThese 41 binary digits represent a Unix timestamp in milliseconds. We need to convert this binary string to a decimal number:\n\ndecimal_value = int(first_41_digits, 2)\nThe decimal value is:\n\n`1716184802070`\n\n**4. Convert to Datetime**\n\nFinally, we convert this Unix timestamp to a human-readable datetime format. Since the timestamp is in milliseconds, we need to divide by 1000 to convert it to seconds before using the datetime module in Python:\n\n```python\nimport datetime\ntimestamp = decimal_value / 1000  # Convert milliseconds to seconds\ndate_time = datetime.datetime.fromtimestamp(timestamp)\n```\n\nThe resulting datetime is:\n\n`2024-05-20 06:00:02.070000`\n\n### Example Result\n\nFollowing these steps, you can transform the activity’s number, `7198200780061900800`, into a precise datetime format, revealing the exact posting date from LinkedIn. For this example, the resulting datetime is:\n\n`May 20, 2024, 06:00:02 AM GMT`\n\n### Full code\n\n``` python\nimport datetime\n\n# Step 1: Transform to binary\nactivity = 7198200780061900800\nbinary_activity = bin(activity)[2:]  # Remove the '0b' prefix\n\n# Step 2: Get the first 41 digits of the binary representation\nfirst_41_digits = binary_activity[:41]\n\n# Step 3: Transform these 41 digits to decimal\ndecimal_value = int(first_41_digits, 2)\n\n# Step 4: Convert the decimal value (UNIX timestamp in milliseconds) to date time format\ntimestamp = decimal_value / 1000  # Convert milliseconds to seconds\ndate_time = datetime.datetime.fromtimestamp(timestamp)\n\nprint(\"Binary Representation:\", binary_activity)\nprint(\"First 41 Binary Digits:\", first_41_digits)\nprint(\"Decimal Value:\", decimal_value)\nprint(\"Date Time:\", date_time)\n```\n\n### Summary\nTo summarise, here are the steps to decode a LinkedIn activity number:\n\n1. Convert the activity number to binary: Use a simple conversion method to get a long string of binary digits.\n2. Extract the first 41 binary digits: These digits encode the timestamp in milliseconds.\n3. Convert these binary digits to a decimal number: This gives you the Unix timestamp in milliseconds.\n4. Interpret the decimal number as a Unix timestamp: Convert it to a human-readable datetime format.\n5. \nFollowing these steps, you can transform any LinkedIn activity number into a readable date and time, helping you understand exactly when a particular activity occurred. This can be especially useful for developers and anyone interested in the precise timing of LinkedIn activities.\n\nFeel free to explore this with other activity numbers in LinkedIn posts’ HTML source code. It’s a handy trick to enhance your understanding of LinkedIn’s data.","src/content/blog/transforming-linkedins-approximate-posting-date-to-the-exact-date-and-time.md","6fd4ebd7ffcb8720",{"html":86,"metadata":87},"\u003Ch1 id=\"transforming-linkedins-approximate-posting-date-to-the-exact-date-and-time\">Transforming LinkedIn’s Approximate Posting Date to the Exact Date and Time\u003C/h1>\n\u003Ch2 id=\"discover-how-to-pinpoint-the-exact-posting-date-from-linkedin-activity-numbers-even-when-you-only-see-1w-or-3d\">Discover How to Pinpoint the Exact Posting Date from LinkedIn Activity Numbers Even When You Only See ‘1w’ or ‘3d’.\u003C/h2>\n\u003Cp>Examining a LinkedIn post’s HTML source shows a long numeric value tied to each activity. This number can be transformed to reveal the exact posting date from LinkedIn. Here’s how you can decode it.\u003C/p>\n\u003Cp>The Original Activity Number\nLet’s start with an example activity number you might find in the HTML code of a LinkedIn post:\u003C/p>\n\u003Cp>\u003Cimg src=\"https://hackmd.io/_uploads/S1hH-S5Dke.png\" alt=\"Getting activity number\">\u003C/p>\n\u003Cp>\u003Ccode>7198200780061900800\u003C/code>\u003C/p>\n\u003Cp>This number is more than just a random value; it actually encodes the exact posting date from LinkedIn in a form that can be decoded.\u003C/p>\n\u003Ch3 id=\"step-by-step-transformation\">Step-by-Step Transformation\u003C/h3>\n\u003Cp>\u003Cstrong>1. Convert to Binary\u003C/strong>\u003C/p>\n\u003Cp>First, we need to convert this number to its binary form. In Python, this can be done using the bin() function:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.y0rd3.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"python\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">activity \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">7198200780061900800\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">binary_activity \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">bin\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(activity)[\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">:]  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Remove the '0b' prefix\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"activity = 7198200780061900800binary_activity = bin(activity)[2:]  # Remove the &#x27;0b&#x27; prefix\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The binary representation looks like this:\u003C/p>\n\u003Cp>\u003Ccode>110001111100101001001010111100011000101100001111000000000000000\u003C/code>\u003C/p>\n\u003Cp>\u003Cstrong>2. Extract the First 41 Digits\u003C/strong>\u003C/p>\n\u003Cp>Next, we extract the first 41 digits from this binary string. These digits are crucial as they encode the Unix timestamp in milliseconds.\u003C/p>\n\u003Cp>first_41_digits = binary_activity[:41]\nThe first 41 binary digits are:\u003C/p>\n\u003Cp>\u003Ccode>11000111110010100100101011110001100010110\u003C/code>\u003C/p>\n\u003Cp>\u003Cstrong>3. Convert Binary to Decimal\u003C/strong>\u003C/p>\n\u003Cp>These 41 binary digits represent a Unix timestamp in milliseconds. We need to convert this binary string to a decimal number:\u003C/p>\n\u003Cp>decimal_value = int(first_41_digits, 2)\nThe decimal value is:\u003C/p>\n\u003Cp>\u003Ccode>1716184802070\u003C/code>\u003C/p>\n\u003Cp>\u003Cstrong>4. Convert to Datetime\u003C/strong>\u003C/p>\n\u003Cp>Finally, we convert this Unix timestamp to a human-readable datetime format. Since the timestamp is in milliseconds, we need to divide by 1000 to convert it to seconds before using the datetime module in Python:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"python\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> datetime\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">timestamp \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> decimal_value \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Convert milliseconds to seconds\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">date_time \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> datetime.datetime.fromtimestamp(timestamp)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import datetimetimestamp = decimal_value / 1000  # Convert milliseconds to secondsdate_time = datetime.datetime.fromtimestamp(timestamp)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The resulting datetime is:\u003C/p>\n\u003Cp>\u003Ccode>2024-05-20 06:00:02.070000\u003C/code>\u003C/p>\n\u003Ch3 id=\"example-result\">Example Result\u003C/h3>\n\u003Cp>Following these steps, you can transform the activity’s number, \u003Ccode>7198200780061900800\u003C/code>, into a precise datetime format, revealing the exact posting date from LinkedIn. For this example, the resulting datetime is:\u003C/p>\n\u003Cp>\u003Ccode>May 20, 2024, 06:00:02 AM GMT\u003C/code>\u003C/p>\n\u003Ch3 id=\"full-code\">Full code\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"python\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#F97583;--1:#BF3441\">import\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> datetime\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Step 1: Transform to binary\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">activity \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">7198200780061900800\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">binary_activity \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">bin\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(activity)[\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">:]  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Remove the '0b' prefix\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Step 2: Get the first 41 digits of the binary representation\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">first_41_digits \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> binary_activity[:\u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">41\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Step 3: Transform these 41 digits to decimal\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">decimal_value \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">int\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(first_41_digits, \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">2\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Step 4: Convert the decimal value (UNIX timestamp in milliseconds) to date time format\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">timestamp \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> decimal_value \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">/\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> \u003C/span>\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">1000\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">  \u003C/span>\u003Cspan style=\"--0:#99A0A6;--1:#616972\"># Convert milliseconds to seconds\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">date_time \u003C/span>\u003Cspan style=\"--0:#F97583;--1:#BF3441\">=\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\"> datetime.datetime.fromtimestamp(timestamp)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">print\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Binary Representation:\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, binary_activity)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">print\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"First 41 Binary Digits:\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, first_41_digits)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">print\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Decimal Value:\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, decimal_value)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#79B8FF;--1:#005CC5\">print\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">(\u003C/span>\u003Cspan style=\"--0:#9ECBFF;--1:#032F62\">\"Date Time:\"\u003C/span>\u003Cspan style=\"--0:#E1E4E8;--1:#24292E\">, date_time)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"import datetime# Step 1: Transform to binaryactivity = 7198200780061900800binary_activity = bin(activity)[2:]  # Remove the &#x27;0b&#x27; prefix# Step 2: Get the first 41 digits of the binary representationfirst_41_digits = binary_activity[:41]# Step 3: Transform these 41 digits to decimaldecimal_value = int(first_41_digits, 2)# Step 4: Convert the decimal value (UNIX timestamp in milliseconds) to date time formattimestamp = decimal_value / 1000  # Convert milliseconds to secondsdate_time = datetime.datetime.fromtimestamp(timestamp)print(&#x22;Binary Representation:&#x22;, binary_activity)print(&#x22;First 41 Binary Digits:&#x22;, first_41_digits)print(&#x22;Decimal Value:&#x22;, decimal_value)print(&#x22;Date Time:&#x22;, date_time)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"summary\">Summary\u003C/h3>\n\u003Cp>To summarise, here are the steps to decode a LinkedIn activity number:\u003C/p>\n\u003Col>\n\u003Cli>Convert the activity number to binary: Use a simple conversion method to get a long string of binary digits.\u003C/li>\n\u003Cli>Extract the first 41 binary digits: These digits encode the timestamp in milliseconds.\u003C/li>\n\u003Cli>Convert these binary digits to a decimal number: This gives you the Unix timestamp in milliseconds.\u003C/li>\n\u003Cli>Interpret the decimal number as a Unix timestamp: Convert it to a human-readable datetime format.\u003C/li>\n\u003Cli>\u003C/li>\n\u003C/ol>\n\u003Cp>Following these steps, you can transform any LinkedIn activity number into a readable date and time, helping you understand exactly when a particular activity occurred. This can be especially useful for developers and anyone interested in the precise timing of LinkedIn activities.\u003C/p>\n\u003Cp>Feel free to explore this with other activity numbers in LinkedIn posts’ HTML source code. It’s a handy trick to enhance your understanding of LinkedIn’s data.\u003C/p>",{"headings":88,"localImagePaths":107,"remoteImagePaths":108,"frontmatter":109,"imagePaths":113},[89,90,94,98,101,104],{"depth":33,"slug":72,"text":75},{"depth":91,"slug":92,"text":93},2,"discover-how-to-pinpoint-the-exact-posting-date-from-linkedin-activity-numbers-even-when-you-only-see-1w-or-3d","Discover How to Pinpoint the Exact Posting Date from LinkedIn Activity Numbers Even When You Only See ‘1w’ or ‘3d’.",{"depth":95,"slug":96,"text":97},3,"step-by-step-transformation","Step-by-Step Transformation",{"depth":95,"slug":99,"text":100},"example-result","Example Result",{"depth":95,"slug":102,"text":103},"full-code","Full code",{"depth":95,"slug":105,"text":106},"summary","Summary",[],[],{"title":75,"description":76,"pubDate":110,"slug":72,"featured":18,"draft":18,"tags":111,"author":112},["Date","2024-06-02T00:00:00.000Z"],[79,80],{"name":53,"link":54},[],"transforming-linkedins-approximate-posting-date-to-the-exact-date-and-time.md","power-automate-lighten-hex-color",{"id":115,"data":117,"body":125,"filePath":126,"digest":127,"rendered":128,"legacyId":157},{"title":118,"description":119,"pubDate":120,"featured":18,"draft":18,"tags":121,"author":124},"Lighten a HEX Color in Power Automate & Logic Apps","Learn how to programmatically lighten HEX color codes in Power Automate and Logic Apps using simple mathematical calculations and color space conversion techniques.",["Date","2025-01-17T00:00:00.000Z"],[122,123],"Power Automate","Logic Apps",{"name":53,"link":54},"# Lighten a HEX Color in Power Automate / Logic Apps\n\nHave you ever needed to adjust a color in your flow—for example, to make it lighter so you can highlight a section of your UI? Below, I’ll show you a simple approach to:\n\n1. Receive a HEX color string, such as `#336699`.\n2. Convert it to its Red, Green, and Blue components.\n3. Lighten each component by a specific factor.\n4. Convert them back into a new HEX string.\n\n---\n\n## Steps to Calculate a Lighter Shade\n\n1. **Convert the HEX color to RGB**  \n   Split the HEX string into its red, green, and blue components, and convert each pair to a decimal value (0–255).\n\n2. **Blend with white**  \n   For each RGB component, calculate the new value by moving closer to white (`255` for each component). This can be done using the following ratio:\n\n   ```\n   New Component = Original Component + (255 - Original Component) × Lighten Factor\n   ```\n\n   - **Original Component**: Decimal value of the R, G, or B component  \n   - **Lighten Factor**: A value between 0 and 1 (e.g., 0.2 for a 20% lighter shade)\n\n3. **Reconvert to HEX**  \n   Convert the modified RGB values back to a two-character HEX format and assemble them into `#RRGGBB`.\n\n### Example\n\nLet’s say you want to lighten `#336699` by **20%** (i.e., a factor of **0.2**):\n\n1. **Convert HEX to RGB**:\n   - `#33` = 51 (decimal R)\n   - `#66` = 102 (decimal G)\n   - `#99` = 153 (decimal B)\n\n2. **Apply the formula**:\n\n   - **Red**:\n     ```\n     51 + (255 - 51) × 0.2\n     = 51 + 40.8\n     = 91.8\n     ≈ 92\n     ```\n   - **Green**:\n     ```\n     102 + (255 - 102) × 0.2\n     = 102 + 30.6\n     = 132.6\n     ≈ 133\n     ```\n   - **Blue**:\n     ```\n     153 + (255 - 153) × 0.2\n     = 153 + 20.4\n     = 173.4\n     ≈ 173\n     ```\n\n3. **Convert back to HEX**:\n   - **Red (92)** → `5C`\n   - **Green (133)** → `85`\n   - **Blue (173)** → `AD`\n\n**Final lighter HEX color**: `#5C85AD`\n\n---\n\n## Flow Steps in Power Automate / Logic Apps\n\n1. **Trigger**  \n   Receive a HEX color (e.g., `#336699`) from Power Apps or another caller.\n\n2. **Initialize Variables**  \n   - `HEX`: Stores the incoming color string.  \n   - `Factor`: A `float` value that determines how much to lighten (e.g., `0.8`).\n\n3. **Compute Decimal RGB**  \n   - Separate the `HEX` string into pairs (R, G, B).\n   - Convert each pair to a decimal value.\n\n4. **Clamp and Lighten**  \n   - For each channel, apply a formula like:\n     ```\n     Clamped_Red = min(\n       255,\n       max(0, Red + (255 - Red) * Factor)\n     )\n     ```\n   - Ensures the value never goes below `0` or above `255`.\n\n5. **Convert Back to HEX**  \n   - Convert each clamped float back into a two-digit hex string.\n   - Remove decimals via substring logic and parse them as integers.\n\n6. **Combine Final HEX**  \n   - Concatenate the three two-digit hex components into a single string: `#RRGGBB`.\n\n7. **Respond**  \n   - Return the new, lightened HEX color to the caller.\n\n---\n\n## Flow Diagram\n\n```mermaid\nflowchart TB\n    A(When Power Apps calls a flow) --> B[HEX]\n    B --> C[Factor]\n    C --> D[Red]\n    C --> E[Green]\n    C --> F[Blue]\n    D --> G[Clamped Red]\n    E --> H[Clamped Green]\n    F --> I[Clamped Blue]\n    G --> J[Lightened Red]\n    H --> K[Lightened Green]\n    I --> L[Lightened Blue]\n    J --> M[Lightened HEX]\n    K --> M\n    L --> M\n    M --> N(Respond to a Power App or flow)\n```\n\n---\n\n## Conclusion\n\nThis approach allows you to **lighten a HEX color** in Power Automate or Logic Apps by splitting out the RGB components, blending each with white using a chosen factor, and reconstructing the final color as `#RRGGBB`. It’s a straightforward way to programmatically adjust colors for various UI or integration scenarios.\n\n**Happy Automating!**","src/content/blog/power-automate-lighten-hex-color.md","fe569d453d4c1b25",{"html":129,"metadata":130},"\u003Ch1 id=\"lighten-a-hex-color-in-power-automate--logic-apps\">Lighten a HEX Color in Power Automate / Logic Apps\u003C/h1>\n\u003Cp>Have you ever needed to adjust a color in your flow—for example, to make it lighter so you can highlight a section of your UI? Below, I’ll show you a simple approach to:\u003C/p>\n\u003Col>\n\u003Cli>Receive a HEX color string, such as \u003Ccode>#336699\u003C/code>.\u003C/li>\n\u003Cli>Convert it to its Red, Green, and Blue components.\u003C/li>\n\u003Cli>Lighten each component by a specific factor.\u003C/li>\n\u003Cli>Convert them back into a new HEX string.\u003C/li>\n\u003C/ol>\n\u003Chr>\n\u003Ch2 id=\"steps-to-calculate-a-lighter-shade\">Steps to Calculate a Lighter Shade\u003C/h2>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Convert the HEX color to RGB\u003C/strong>\u003Cbr>\nSplit the HEX string into its red, green, and blue components, and convert each pair to a decimal value (0–255).\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Blend with white\u003C/strong>\u003Cbr>\nFor each RGB component, calculate the new value by moving closer to white (\u003Ccode>255\u003C/code> for each component). This can be done using the following ratio:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.y0rd3.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">New Component = Original Component + (255 - Original Component) × Lighten Factor\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"New Component = Original Component + (255 - Original Component) × Lighten Factor\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cul>\n\u003Cli>\u003Cstrong>Original Component\u003C/strong>: Decimal value of the R, G, or B component\u003C/li>\n\u003Cli>\u003Cstrong>Lighten Factor\u003C/strong>: A value between 0 and 1 (e.g., 0.2 for a 20% lighter shade)\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Reconvert to HEX\u003C/strong>\u003Cbr>\nConvert the modified RGB values back to a two-character HEX format and assemble them into \u003Ccode>#RRGGBB\u003C/code>.\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Ch3 id=\"example\">Example\u003C/h3>\n\u003Cp>Let’s say you want to lighten \u003Ccode>#336699\u003C/code> by \u003Cstrong>20%\u003C/strong> (i.e., a factor of \u003Cstrong>0.2\u003C/strong>):\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Convert HEX to RGB\u003C/strong>:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>#33\u003C/code> = 51 (decimal R)\u003C/li>\n\u003Cli>\u003Ccode>#66\u003C/code> = 102 (decimal G)\u003C/li>\n\u003Cli>\u003Ccode>#99\u003C/code> = 153 (decimal B)\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Apply the formula\u003C/strong>:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Red\u003C/strong>:\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">51 + (255 - 51) × 0.2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 51 + 40.8\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 91.8\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">≈ 92\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"51 + (255 - 51) × 0.2= 51 + 40.8= 91.8≈ 92\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\u003Cstrong>Green\u003C/strong>:\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">102 + (255 - 102) × 0.2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 102 + 30.6\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 132.6\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">≈ 133\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"102 + (255 - 102) × 0.2= 102 + 30.6= 132.6≈ 133\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\u003Cstrong>Blue\u003C/strong>:\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">153 + (255 - 153) × 0.2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 153 + 20.4\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">= 173.4\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">≈ 173\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"153 + (255 - 153) × 0.2= 153 + 20.4= 173.4≈ 173\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Convert back to HEX\u003C/strong>:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Red (92)\u003C/strong> → \u003Ccode>5C\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>Green (133)\u003C/strong> → \u003Ccode>85\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>Blue (173)\u003C/strong> → \u003Ccode>AD\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Cstrong>Final lighter HEX color\u003C/strong>: \u003Ccode>#5C85AD\u003C/code>\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"flow-steps-in-power-automate--logic-apps\">Flow Steps in Power Automate / Logic Apps\u003C/h2>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Trigger\u003C/strong>\u003Cbr>\nReceive a HEX color (e.g., \u003Ccode>#336699\u003C/code>) from Power Apps or another caller.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Initialize Variables\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>HEX\u003C/code>: Stores the incoming color string.\u003C/li>\n\u003Cli>\u003Ccode>Factor\u003C/code>: A \u003Ccode>float\u003C/code> value that determines how much to lighten (e.g., \u003Ccode>0.8\u003C/code>).\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Compute Decimal RGB\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Separate the \u003Ccode>HEX\u003C/code> string into pairs (R, G, B).\u003C/li>\n\u003Cli>Convert each pair to a decimal value.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Clamp and Lighten\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>For each channel, apply a formula like:\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plaintext\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">Clamped_Red = min(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">255,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">max(0, Red + (255 - Red) * Factor)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Clamped_Red = min(  255,  max(0, Red + (255 - Red) * Factor))\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>Ensures the value never goes below \u003Ccode>0\u003C/code> or above \u003Ccode>255\u003C/code>.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Convert Back to HEX\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Convert each clamped float back into a two-digit hex string.\u003C/li>\n\u003Cli>Remove decimals via substring logic and parse them as integers.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Combine Final HEX\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Concatenate the three two-digit hex components into a single string: \u003Ccode>#RRGGBB\u003C/code>.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Respond\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Return the new, lightened HEX color to the caller.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ol>\n\u003Chr>\n\u003Ch2 id=\"flow-diagram\">Flow Diagram\u003C/h2>\n\u003Csvg aria-roledescription=\"flowchart-v2\" role=\"graphics-document document\" viewBox=\"0 0 626.0625 846\" style=\"max-width: 626.0625px;\" class=\"flowchart\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" id=\"mermaid-0\">\u003Cstyle>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#333;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span{color:#333;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#333;color:#333;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#333333;fill:none;}#mermaid-0 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}\u003C/style>\u003Cg>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointEnd\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 0 L 10 5 L 0 10 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"4.5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointStart\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 5 L 10 10 L 10 0 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"11\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleEnd\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"-1\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleStart\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"12\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossEnd\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"-1\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossStart\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cg class=\"root\">\u003Cg class=\"clusters\">\u003C/g>\u003Cg class=\"edgePaths\">\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_B_0\" d=\"M311.695,86L311.695,90.167C311.695,94.333,311.695,102.667,311.695,110.333C311.695,118,311.695,125,311.695,128.5L311.695,132\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_C_0\" d=\"M311.695,190L311.695,194.167C311.695,198.333,311.695,206.667,311.695,214.333C311.695,222,311.695,229,311.695,232.5L311.695,236\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_D_0\" d=\"M259.023,279.357L230.861,285.964C202.698,292.571,146.372,305.786,118.21,315.893C90.047,326,90.047,333,90.047,336.5L90.047,340\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_E_0\" d=\"M311.695,294L311.695,298.167C311.695,302.333,311.695,310.667,311.695,318.333C311.695,326,311.695,333,311.695,336.5L311.695,340\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_F_0\" d=\"M364.367,279.283L392.753,285.903C421.138,292.522,477.909,305.761,506.294,315.881C534.68,326,534.68,333,534.68,336.5L534.68,340\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_D_G_0\" d=\"M90.047,398L90.047,402.167C90.047,406.333,90.047,414.667,90.047,422.333C90.047,430,90.047,437,90.047,440.5L90.047,444\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_E_H_0\" d=\"M311.695,398L311.695,402.167C311.695,406.333,311.695,414.667,311.695,422.333C311.695,430,311.695,437,311.695,440.5L311.695,444\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_F_I_0\" d=\"M534.68,398L534.68,402.167C534.68,406.333,534.68,414.667,534.68,422.333C534.68,430,534.68,437,534.68,440.5L534.68,444\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_G_J_0\" d=\"M90.047,502L90.047,506.167C90.047,510.333,90.047,518.667,90.047,526.333C90.047,534,90.047,541,90.047,544.5L90.047,548\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_H_K_0\" d=\"M311.695,502L311.695,506.167C311.695,510.333,311.695,518.667,311.695,526.333C311.695,534,311.695,541,311.695,544.5L311.695,548\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_I_L_0\" d=\"M534.68,502L534.68,506.167C534.68,510.333,534.68,518.667,534.68,526.333C534.68,534,534.68,541,534.68,544.5L534.68,548\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_J_M_0\" d=\"M90.047,606L90.047,610.167C90.047,614.333,90.047,622.667,112.369,632.07C134.691,641.474,179.336,651.948,201.658,657.185L223.981,662.422\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_K_M_0\" d=\"M311.695,606L311.695,610.167C311.695,614.333,311.695,622.667,311.695,630.333C311.695,638,311.695,645,311.695,648.5L311.695,652\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_L_M_0\" d=\"M534.68,606L534.68,610.167C534.68,614.333,534.68,622.667,512.135,632.091C489.59,641.515,444.501,652.03,421.956,657.287L399.411,662.545\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_M_N_0\" d=\"M311.695,710L311.695,714.167C311.695,718.333,311.695,726.667,311.695,734.333C311.695,742,311.695,749,311.695,752.5L311.695,756\">\u003C/path>\u003C/g>\u003Cg class=\"edgeLabels\">\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg class=\"edgeLabel\">\u003Cg transform=\"translate(0, 0)\" class=\"label\">\u003CforeignObject height=\"0\" width=\"0\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"nodes\">\u003Cg transform=\"translate(311.6953125, 47)\" id=\"flowchart-A-0\" class=\"node default\">\u003Crect height=\"78\" width=\"230\" y=\"-39\" x=\"-115\" ry=\"5\" rx=\"5\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-100, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>When Power Apps calls a flow\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 163)\" id=\"flowchart-B-1\" class=\"node default\">\u003Crect height=\"54\" width=\"92.90625\" y=\"-27\" x=\"-46.453125\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-16.453125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"32.90625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>HEX\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 267)\" id=\"flowchart-C-3\" class=\"node default\">\u003Crect height=\"54\" width=\"105.34375\" y=\"-27\" x=\"-52.671875\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-22.671875, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"45.34375\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Factor\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(90.046875, 371)\" id=\"flowchart-D-5\" class=\"node default\">\u003Crect height=\"54\" width=\"89.359375\" y=\"-27\" x=\"-44.6796875\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-14.6796875, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"29.359375\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Red\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 371)\" id=\"flowchart-E-7\" class=\"node default\">\u003Crect height=\"54\" width=\"104.46875\" y=\"-27\" x=\"-52.234375\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-22.234375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"44.46875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Green\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(534.6796875, 371)\" id=\"flowchart-F-9\" class=\"node default\">\u003Crect height=\"54\" width=\"92.03125\" y=\"-27\" x=\"-46.015625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-16.015625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"32.03125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Blue\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(90.046875, 475)\" id=\"flowchart-G-11\" class=\"node default\">\u003Crect height=\"54\" width=\"157.828125\" y=\"-27\" x=\"-78.9140625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-48.9140625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"97.828125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Clamped Red\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 475)\" id=\"flowchart-H-13\" class=\"node default\">\u003Crect height=\"54\" width=\"172.953125\" y=\"-27\" x=\"-86.4765625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-56.4765625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"112.953125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Clamped Green\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(534.6796875, 475)\" id=\"flowchart-I-15\" class=\"node default\">\u003Crect height=\"54\" width=\"160.5\" y=\"-27\" x=\"-80.25\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-50.25, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"100.5\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Clamped Blue\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(90.046875, 579)\" id=\"flowchart-J-17\" class=\"node default\">\u003Crect height=\"54\" width=\"164.09375\" y=\"-27\" x=\"-82.046875\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-52.046875, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"104.09375\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Lightened Red\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 579)\" id=\"flowchart-K-19\" class=\"node default\">\u003Crect height=\"54\" width=\"179.203125\" y=\"-27\" x=\"-89.6015625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-59.6015625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"119.203125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Lightened Green\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(534.6796875, 579)\" id=\"flowchart-L-21\" class=\"node default\">\u003Crect height=\"54\" width=\"166.765625\" y=\"-27\" x=\"-83.3828125\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-53.3828125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"106.765625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Lightened Blue\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 683)\" id=\"flowchart-M-23\" class=\"node default\">\u003Crect height=\"54\" width=\"167.640625\" y=\"-27\" x=\"-83.8203125\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-53.8203125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"107.640625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Lightened HEX\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(311.6953125, 799)\" id=\"flowchart-N-29\" class=\"node default\">\u003Crect height=\"78\" width=\"230\" y=\"-39\" x=\"-115\" ry=\"5\" rx=\"5\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-100, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Respond to a Power App or flow\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/svg>\n\u003Chr>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>This approach allows you to \u003Cstrong>lighten a HEX color\u003C/strong> in Power Automate or Logic Apps by splitting out the RGB components, blending each with white using a chosen factor, and reconstructing the final color as \u003Ccode>#RRGGBB\u003C/code>. It’s a straightforward way to programmatically adjust colors for various UI or integration scenarios.\u003C/p>\n\u003Cp>\u003Cstrong>Happy Automating!\u003C/strong>\u003C/p>",{"headings":131,"localImagePaths":150,"remoteImagePaths":151,"frontmatter":152,"imagePaths":156},[132,135,138,141,144,147],{"depth":33,"slug":133,"text":134},"lighten-a-hex-color-in-power-automate--logic-apps","Lighten a HEX Color in Power Automate / Logic Apps",{"depth":91,"slug":136,"text":137},"steps-to-calculate-a-lighter-shade","Steps to Calculate a Lighter Shade",{"depth":95,"slug":139,"text":140},"example","Example",{"depth":91,"slug":142,"text":143},"flow-steps-in-power-automate--logic-apps","Flow Steps in Power Automate / Logic Apps",{"depth":91,"slug":145,"text":146},"flow-diagram","Flow Diagram",{"depth":91,"slug":148,"text":149},"conclusion","Conclusion",[],[],{"title":118,"description":119,"pubDate":153,"slug":115,"featured":18,"draft":18,"tags":154,"author":155},["Date","2025-01-17T00:00:00.000Z"],[122,123],{"name":53,"link":54},[],"power-automate-lighten-hex-color.md","beaten-by-the-best-and-come-back-for-more",{"id":158,"data":160,"body":167,"filePath":168,"digest":169,"rendered":170,"legacyId":183},{"title":161,"description":162,"pubDate":163,"featured":18,"draft":18,"tags":164,"author":166},"Beaten by the best and come back for more","Alex, my six-year-old, struggled in his first soccer training but remained enthusiastic. His resilience taught me to embrace failure and persist. Once again, I'm learning from my young teacher.",["Date","2019-05-01T00:00:00.000Z"],[165],"Personal",{"name":53,"link":54},"# Beaten by the best and come back for more.\n\n\n\n```mermaid\n\nflowchart LR\n    A((M Script))\n    B(Mashup engine)\n    C[Data source] \n    D[Output]\n\n    A -- \"(1) Instructs\" --> B\n    B -- \"(1) Query Data\" --> C\n    C -- \"(2) Returns Data\" --> B\n    B -- \"(3) Loads data\" --> D\n\n\n    subgraph \"Mashup Execution Environment\"\n            B\n    end\n\n```\n\n\n![Beaten by the best](https://github.com/OscarValerock/OscarValerock/blob/main/src/content/blog/beaten-by-the-best-and-come-back-for-more/Beaten%20by%20the%20best.jpg?raw=true)\n\nIt was extremely tough, and everyone else was faster, stronger, better; he felt and bit dust countless times, and did not achieve a single objective, the team leader thought he might be misplaced, that he didn´t belong there; he will come back for more.\n\nWelcome to the first soccer training day of Alex, my six-year-old boy. After he told me how hard it was for him, I asked if he wanted to go back, his answer couldn´t be more impressive: Yes dad, I loved to participate!!!\n\nMy children have always thought me invaluable lessons, and this was one more: resilience and perseverance. Children, since they are born, fail a thousand times a day, they don´t give a damn about what others say, they don´t feel pity for themselves, they stand up, learn from the errors and keep trying.\n\nOnce more, I will humble myself and do my best to learn this valuable lesson from my six-year-old teacher: compete with the best, fail, stand up, learn and come back for more.","src/content/blog/beaten-by-the-best-and-come-back-for-more.md","55c5615a06be0d4b",{"html":171,"metadata":172},"\u003Ch1 id=\"beaten-by-the-best-and-come-back-for-more\">Beaten by the best and come back for more.\u003C/h1>\n\u003Csvg aria-roledescription=\"flowchart-v2\" role=\"graphics-document document\" viewBox=\"0 0 728.09375 209\" style=\"max-width: 728.09375px;\" class=\"flowchart\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" id=\"mermaid-0\">\u003Cstyle>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#333;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span{color:#333;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#333;color:#333;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#333333;fill:none;}#mermaid-0 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}\u003C/style>\u003Cg>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointEnd\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 0 L 10 5 L 0 10 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"4.5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointStart\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 5 L 10 10 L 10 0 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"11\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleEnd\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"-1\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleStart\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"12\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossEnd\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"-1\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossStart\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cg class=\"root\">\u003Cg class=\"clusters\">\u003Cg data-look=\"classic\" id=\"subGraph0\" class=\"cluster\">\u003Crect height=\"186\" width=\"208\" y=\"8\" x=\"206.8515625\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(210.8515625, 8)\" class=\"cluster-label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup Execution Environment\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"edgePaths\">\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_B_0\" d=\"M81.672,111L92.878,111C104.083,111,126.495,111,148.906,111C171.318,111,193.729,111,208.435,111C223.141,111,230.141,111,233.641,111L237.141,111\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_C_0\" d=\"M351.442,84L360.462,78C369.482,72,387.522,60,410.565,54C433.607,48,461.651,48,489.035,49.869C516.419,51.738,543.143,55.477,556.505,57.346L569.867,59.215\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_B_0\" d=\"M573.828,83.951L559.806,86.626C545.784,89.301,517.74,94.65,489.695,97.325C461.651,100,433.607,100,416.08,100.407C398.554,100.814,391.545,101.628,388.04,102.035L384.536,102.442\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_D_0\" d=\"M351.442,138L360.462,144C369.482,150,387.522,162,410.565,168C433.607,174,461.651,174,492.215,174C522.779,174,555.862,174,572.404,174L588.945,174\">\u003C/path>\u003C/g>\u003Cg class=\"edgeLabels\">\u003Cg transform=\"translate(148.90625, 111)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-42.234375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"84.46875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Instructs\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 48)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-52.90625, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"105.8125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Query Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 100)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-59.1328125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"118.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(2) Returns Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 174)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-51.59375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"103.1875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(3) Loads data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"nodes\">\u003Cg transform=\"translate(44.8359375, 111)\" id=\"flowchart-A-0\" class=\"node default\">\u003Ccircle cy=\"0\" cx=\"0\" r=\"36.8359375\" style=\"\" class=\"basic label-container\">\u003C/circle>\u003Cg transform=\"translate(-29.3359375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"58.671875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>M Script\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(310.8515625, 111)\" id=\"flowchart-B-1\" class=\"node default\">\u003Crect height=\"54\" width=\"139.421875\" y=\"-27\" x=\"-69.7109375\" ry=\"5\" rx=\"5\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-54.7109375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"109.421875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup engine\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(646.9609375, 70)\" id=\"flowchart-C-2\" class=\"node default\">\u003Crect height=\"54\" width=\"146.265625\" y=\"-27\" x=\"-73.1328125\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-43.1328125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"86.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Data source\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(646.9609375, 174)\" id=\"flowchart-D-3\" class=\"node default\">\u003Crect height=\"54\" width=\"108.03125\" y=\"-27\" x=\"-54.015625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-24.015625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"48.03125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Output\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/svg>\n\u003Cp>\u003Cimg src=\"https://github.com/OscarValerock/OscarValerock/blob/main/src/content/blog/beaten-by-the-best-and-come-back-for-more/Beaten%20by%20the%20best.jpg?raw=true\" alt=\"Beaten by the best\">\u003C/p>\n\u003Cp>It was extremely tough, and everyone else was faster, stronger, better; he felt and bit dust countless times, and did not achieve a single objective, the team leader thought he might be misplaced, that he didn´t belong there; he will come back for more.\u003C/p>\n\u003Cp>Welcome to the first soccer training day of Alex, my six-year-old boy. After he told me how hard it was for him, I asked if he wanted to go back, his answer couldn´t be more impressive: Yes dad, I loved to participate!!!\u003C/p>\n\u003Cp>My children have always thought me invaluable lessons, and this was one more: resilience and perseverance. Children, since they are born, fail a thousand times a day, they don´t give a damn about what others say, they don´t feel pity for themselves, they stand up, learn from the errors and keep trying.\u003C/p>\n\u003Cp>Once more, I will humble myself and do my best to learn this valuable lesson from my six-year-old teacher: compete with the best, fail, stand up, learn and come back for more.\u003C/p>",{"headings":173,"localImagePaths":176,"remoteImagePaths":177,"frontmatter":178,"imagePaths":182},[174],{"depth":33,"slug":158,"text":175},"Beaten by the best and come back for more.",[],[],{"title":161,"description":162,"pubDate":179,"slug":158,"featured":18,"draft":18,"tags":180,"author":181},["Date","2019-05-01T00:00:00.000Z"],[165],{"name":53,"link":54},[],"beaten-by-the-best-and-come-back-for-more.md","data-exfiltration-in-power-query",{"id":184,"data":186,"body":199,"filePath":200,"digest":201,"rendered":202,"legacyId":244},{"title":187,"description":188,"pubDate":189,"featured":18,"draft":18,"tags":190,"author":193,"reviewedBy":196},"Data Exfiltration in Power Query - Understanding the Risk and Protections","Data Exfiltration in Power Query: Understanding the Risk and Protections",["Date","2025-04-21T00:00:00.000Z"],[191,192],"Power Query","Security",{"name":194,"link":195},"Oscar Martínez Valero","https://www.linkedin.com/in/oscarmartinezv/",{"name":197,"link":198},"Alex Dean","https://www.linkedin.com/in/alxdean","## What is Data Exfiltration in Power Query?\nData exfiltration is the act of moving sensitive data outside a trusted environment without authorization. In the context of Power Query (the data transformation engine behind Excel, Power BI, dataflows, etc.), this means an insider could use a Power Query script to siphon data from secure sources (like databases) out to an external destination. Microsoft defines data exfiltration as occurring when sensitive business data is accidentally or intentionally moved outside of a trusted boundary.[^1]\n\nPower Query is powerful – it can connect to hundreds of data sources and, importantly, it can make web requests. By default, when Power Query runs in cloud services (e.g. Power BI dataflows or datamarts), it executes in the Power Query Online Mashup Engine, which operates in Microsoft's cloud with unrestricted internet access.[^2] In other words, if a user's Power Query code is executed in the cloud, it can potentially send data to any external endpoint on the internet. This creates a potential security blind spot for organizations: a savvy user with data access can craft a query that exfiltrates (sends out) sensitive data, bypassing typical network protections.\n\n## Mashup Query Engine\n\nThe Mashup Engine is the core component of Power Query responsible for executing data extraction, transformation, and loading (ETL) processes. It interprets the M scripts—Power Query's formula language—and performs the operations defined within them.[^3]\n\n### Mashup Execution Environment\n\nThe Mashup Engine operates within different environments depending on where Power Query is utilized:\n\n* **Desktop Applications:** In tools like Excel and Power BI Desktop, the Mashup Engine runs locally on the user's machine, leveraging local resources for data processing.\n* **Cloud Services:** In the Power BI service, the Mashup Engine executes in the cloud, utilizing Microsoft's infrastructure to process data.\n* **On-Premises Data Gateway:** When accessing on-premises data sources from cloud services, the Mashup Engine operates through the data gateway, ensuring secure data transmission between on-premises sources and cloud services.\n\n```mermaid\n\nflowchart LR\n    A((M Script))\n    B(Mashup engine)\n    C[Data source] \n    D[Output]\n\n    A -- \"(1) Instructs\" --> B\n    B -- \"(1) Query Data\" --> C\n    C -- \"(2) Returns Data\" --> B\n    B -- \"(3) Loads data\" --> D\n\n\n    subgraph \"Mashup Execution Environment\"\n            B\n    end\n\n```\n\n## How Can Power Query M Code Exfiltrate Data?\nPower Query's M language allows combining data from multiple sources and calling web endpoints and Power Query can query a secure database and then silently send that data to an external web service. Let's illustrate with a simplified snippet of Power Query M code that demonstrates the core concept of data exfiltration:\n\n\n```pq\nlet\n    // Step 1\n    SourceData = Read data from a secure SQL database,\n    // Step 2\n    Convert = Convert the data for transmission,\n    // Step 3\n    Result = Send the data out to an external API endpoint\nin\n    Result\n```\n\n> Figure: Simplified snippet of Power Query M code\n    \nIn this example, the query connects to a Secure SQL Database (e.g. an internal FinanceDB) and retrieves data. Then it converts that data and uses a function to send the data to an external web service. The `Result` of the web call (if any) is returned by the query, but the key point is that the sensitive data has now left the organization – it's been sent to an external server controlled by the attacker.\n\nMicrosoft's own documentation explicitly notes this risk: \"By using Web.Contents, users can make web requests with sensitive data in the body of the request\".[^4] \n\n```mermaid\n\nflowchart LR\n    A((M Script))\n    B(Mashup engine)\n    C[SQL Data base] \n    D[Semantic Model]\n    E[External API Endpoint\u003Cbr/>attacker-controlled]\n\n    A -- \"(1) Instructs\" --> B\n    B -- \"(1) Query Data\" --> C\n    C -- \"(2) Returns Sensitive Data\" --> B\n    B -- \"(3) Loads data\" --> D\n    B -- \"(4) HTTP POST \u003C/br>Sensitive Data\" --> E\n\n    subgraph \"Corp Network Boundary\"\n        C\n    end\n    subgraph \"Cloud Execution Environment\"\n        B\n    end\n        E:::outside\n        classDef outside fill:#fdd\n\n```\n> Figure: Data Exfiltration Path via Power Query – The diagram above shows how an insider's Power Query can extract data from a secure database and send it to an outside API, all within a single Power Query execution.\n\nIn the above flow, the Power Query Mashup Engine (running in the cloud) has access to the secure SQL database (using provided credentials). It queries the data and then loads it into a semantic model **and out over the internet to an external endpoint.** Notice that this exfiltration can occur even if the data source is inside the corporate network – the Mashup Engine runs outside the network by default, so it isn't subject to the organization's internal firewalls or DLP scanners in the usual way.[^5] Effectively, the Power Query is acting as a bridge between the secure data source and the attacker's server.\n\n## Why Is It Hard to Prevent This? (No Foolproof Safeguard)\n\nIt may be startling, but there is currently no foolproof way to completely prevent data exfiltration from a Power Query file under Microsoft's current model. If a user has access to create or edit Power Query queries (in Excel, Power BI, dataflows, etc.) and they have access to some sensitive data source, they can potentially craft M code to leak that data. The Power Query runtime will happily execute the code as long as the user is authorized to access the sources and run queries. \n\nBy design, the default Power Query Online environment trusts the user's code and has no fine-grained content inspection or egress filtering of its own. Microsoft warns that the cloud-based Mashup Engine runs outside the tenant's network and is not subject to corporate firewalls or DLP policies, meaning data can flow to any destination the user has access to.[^6] In essence, once the query is running, the service will perform whatever data connections the code specifies – whether that's pulling from a database or pushing to an external URL. There is no built-in setting like \"disable web access in queries\" or \"allow queries to only connect to approved endpoints\" at the Power Query level today. This is why the problem is often described as an insider threat scenario; it assumes the person executing the query is authorized to access the data in the first place, and then abuses that privilege. \n\nTo reiterate, no native Power Query setting can outright stop a determined user from embedding an exfiltration step in their M code. Organizations must instead rely on broader security strategies to mitigate this risk. Microsoft's guidance (as of early 2024) focuses on external controls – essentially making it harder for that malicious query to succeed by constraining where and how Power Query code runs. Below we'll examine the current best practices and protections Microsoft recommends, and then why those measures still have limitations.\n\n## Microsoft's Recommended Protections and Best Practices\n\nMicrosoft has acknowledged the data exfiltration risk in official documentation and outlines several best practices to help protect against it.[^7][^8]\n\nThese protections mainly involve network-level controls and execution policies rather than application-level restrictions in Power Query itself. The key strategies include:\n\n* **Network Isolation of Data Sources:** Lock down your sensitive data sources so that they can only be accessed from approved network locations. For example, use firewall rules, Azure Virtual Network service endpoints, Private Links, or network security groups to ensure that the database or data source cannot be reached directly from the public Internet.[^9] The idea is to obstruct line-of-sight from the cloud-based Power Query engine to your data. If the Power Query Mashup Engine (running in the cloud) tries to connect to a protected database that isn't reachable outside the corporate network, the connection will fail.[^10] In practice, this often means forcing the query to go through an on-premises data gateway or a VNet gateway that resides in your network. Microsoft notes that when a dataflow or query is bound to a gateway (due to the source being isolated), all data access in that query will occur via that gateway – cloud and gateway execution are never mixed in a single query.[^11] Because the gateway runs within your controlled environment, it will be subject to your organization's firewalls, network monitoring, and DLP solutions.[^12] Essentially, network isolation + gateway enforcement makes the Power Query run as if it were on a corporate machine, where you can apply your usual outbound restrictions (for instance, blocking it from calling unknown external websites).\n\n```mermaid\nflowchart LR\n    A((M Script))\n    B[Cloud Execution\u003Cbr/>Environment]\n    C[Sensitive\u003Cbr/>Database]\n    E[External API\u003Cbr/>attacker-controlled]\n    H[Semantic\u003Cbr/>Model]\n\n    subgraph \"Corporate Network Boundary\"\n        A\n        \n        subgraph D[Gateway Execution Environment]\n            G[Mashup Engine]\n            F1[/🧱 Firewall\\]\n        end\n        \n        \n        C\n        H\n    end\n\n    %% Cloud engine bypassed\n    A -- \"(1) Instructs\" --> G\n    A -. \"Not used\" .-> B\n    \n    %% Gateway execution - now through both firewalls\n    G -- \"(2) Request\" --> F1\n    F1 -- \"(3) Safelisted\u003Cbr/>Request\" --> C\n    \n    %% Return data flow\n    C -- \"(4) Returns Data\" --> F1\n    F1 -- \"(5) Returns Data\" --> G\n\n    %% Outbound control\n\n    G --(6) Tries to send data --> F1\n    F1 -. \"(7) ❌ Blocked by firewall rules\" .-> E\n    G -- \"(8) ❌ Data Load Failure\" --> H\n    \n    B:::disabled\n    E:::outside\n    classDef outside fill:#fdd\n    classDef disabled fill:#eee,stroke-dasharray: 5 5\n```\n\n* **Force On-Premises (Gateway) Execution:** If truly necessary, an organization can disable cloud execution of Power Query entirely, **forcing all queries to run through on-premises gateways.** Currently, Microsoft offers this as a tenant-wide policy (set via a support ticket) that turns off the Power Query Online Mashup Engine for the entire tenant.[^13][^14] After this policy is applied, any attempt at cloud evaluation will fail with an error like *\"Cloud evaluation request denied based on tenant policies. Please use a data gateway and try again.\"*[^15] This effectively guarantees that none of your Power Query code runs in Microsoft's cloud environment – everything has to go through a gateway that you control. However, this is a very blunt measure: it's all or nothing (more on the drawbacks later). Microsoft notes that this policy impacts all dataflow-like operations (Power BI dataflows, Fabric dataflows, Power Platform dataflows, datamarts, etc.), and it is applied tenant-wide, not to specific workspaces or users.[^16] In other words, you can't selectively allow some cloud executions and block others with this policy; turning it on will break any queries that were not already using a gateway, until they are reconfigured.\n\n* **Tenant and Identity Policies:** Another aspect of Microsoft's guidance is to use identity-driven controls to prevent data from leaving the organization's tenant or being accessed by unauthorized users. For cloud SaaS data stores (like Dataverse, Fabric Lakehouse, or even Power BI itself as a data source), pure network isolation might not be feasible because these services have multi-tenant endpoints. Instead, Microsoft recommends tenant isolation policies at the Azure AD (Entra ID) level.[^17][^18] Examples include: only allow authentication via your organization's Azure AD (no using generic usernames/passwords or anonymous access to data sources), enforce location-based conditional access so that only users on managed devices (e.g. corporate laptops or network) can access the Power BI/Fabric service, and use tenant restrictions to block your users from signing into other tenants' Power BI environments (and vice versa).[^19] These measures help ensure that a user can't, say, use their credentials on an external Power BI tenant or tool to pull data out, and that only approved devices within your org can run queries. While these identity-centric controls don't directly stop something like `Web.Contents` calls, they do guard against certain exfiltration paths (such as an employee trying to shuttle data to another cloud tenant or personal account).\n\n* **Governance and Monitoring:** In addition to preventive controls, Microsoft is adding auditing and governance features to address this gap. Administrators can leverage Power BI/Fabric audit logs (via Microsoft Purview) to monitor data connection activities.[^20][^21] Every time a Power Query data source connection is created or used, it can be logged with details like who ran it, what data source was accessed, and whether a gateway was involved.[^22][^23] This doesn't stop an exfiltration attempt in real-time, but it provides a trail that could identify suspicious behavior (for example, a user suddenly using a Web data source or an unknown API in their query). Microsoft's roadmap also includes features like data source allowlisting – which will let tenant admins restrict what connectors or endpoints can be used in Power Query – and enhanced auditing of query activities.[^24] These are not yet fully available as of this writing, but they indicate that finer-grained controls are on the way.\n\nIn summary, Microsoft's current best practices to mitigate Power Query exfiltration risks involve shifting execution into controlled environments (gateways or isolated networks), and layering on network/identity policies and monitoring. All of these assume the organization takes explicit action to constrain how Power Query runs. If you do nothing, the default is that the Power Query Online engine will run your code in the cloud with open internet access – a scenario in which an insider could potentially send data anywhere.[^25][^26]\n\n## Limitations and Shortcomings of the Current Approach\n\nWhile the above measures can reduce the risk, they come with significant limitations. It's important to understand these shortcomings:\n\n* **Heavy Reliance on Network Layer Security:** The primary defense is essentially \"don't let the cloud engine talk to anything it shouldn't\" by using network isolation. This puts a lot of onus on infrastructure setup – every sensitive data source must be properly firewalled or put behind private networks. Any gap (for instance, a database that allows public IP access or an allowed outbound route to the internet) can be exploited by a malicious query. Microsoft explicitly notes that higher-layer controls like app-level policies or conditional access are not sufficient; you really need network-level or lower isolation for sensitive data.[^27] Not every organization is prepared to enforce strict network rules for all data sources, and doing so can be complex and costly (especially if you have many data systems). In short, the current model leans on traditional network security – if that's not airtight, Power Query can punch through it.\n\n* **No Fine-Grained Power Query Controls:** Today, there is a lack of fine-grained controls within Power Query itself. If you allow people to author queries, you are inherently allowing them to use the full M language power. There's no built-in way to say \"user X's queries cannot call Web.Contents\" or \"only allow queries to connect to domain Y\" in the Power BI or Excel UI. The platform doesn't let an admin easily restrict specific functions or external calls on a per-file or per-workspace basis. The all-or-nothing tenant policy to disable cloud execution is basically the only switch, and it doesn't discriminate between \"good\" and \"bad\" queries. Microsoft has recognized this gap – hence the planned feature to allowlist or block specific connectors/endpoints.[^28] – but until that arrives, organizations have limited options. This means a determined insider with edit rights can use any connector or function at their disposal in M. Even if you only give someone access to one data source, they could still combine it with a Web connector in the query to send data out. There is also no content inspection of the M script by the service that could catch something like \"hey, this query is posting data to an unknown URL\" – it will just execute it.\n\n* **Tenant-Level \"Kill Switch\" is All or Nothing:** The strongest preventive measure available – turning off the cloud Mashup Engine – applies to the entire tenant and all Power Query workloads.[^29] This is a very coarse control. In a large organization, completely forcing gateway execution can be disruptive: all dataflows, datamarts, and even certain Power BI features (like Quick Import from SharePoint or some transformations) will stop running in the cloud and require a gateway or will break.[^30] There's no way to enforce the restriction for only a subset of workspaces or only for certain users. It's also not a toggle you can self-serve in the admin portal as of now – it requires filing a support ticket to get it enabled.[^31] Because it's tenant-wide, if you enable it, you need to have gateways set up for every scenario, and sufficient capacity on those gateways to handle the load.[^32] This heavy-handed approach might be unacceptable for organizations that rely on cloud dataflows for convenience or have many existing cloud refreshes. In practice, many companies hesitate to use this nuclear option, leaving them to rely on the network and policy approaches above – which, as noted, are not foolproof.\n\n* **Insider Threat Still Exists:** Even with all the controls, remember that these measures primarily make it harder (or more detectable) to exfiltrate data – they don't eliminate the possibility entirely. For example, if an organization allows Power Query to run in the cloud for convenience, and just trusts network isolation, a savvy insider might still find an endpoint that is allowed. Or if an on-premises gateway is used, but that gateway machine itself has unrestricted internet access, the query's `Web.Contents` call could run through the gateway and out to the internet (unless the gateway's environment is locked down by network rules). Identity policies (like tenant restrictions or managed device requirements) help prevent certain routes of exfiltration (such as using an external tenant or unmanaged PC), but they don't stop a query from sending data to an anonymous external API from within an allowed session. Ultimately, an authorized user abusing their data access via Power Query is difficult to stop without either removing their access or implementing very restrictive infrastructure controls.\n\n* **Lack of Visibility and Granular Auditing:** Although auditing capabilities are improving, it can still be non-trivial to spot what exactly a query is doing. The audit logs will tell you that a data source was accessed or maybe that a Web data source was used, but they won't necessarily flag \"this query sent 500 customer records to example.com.\" There's no content inspection of the payload in logs. So detection of malicious use might require correlating logs (e.g. noticing that right after someone accessed a sensitive SQL data source, they also made a series of web calls). This is more of a SOC (Security Operations) challenge – and many orgs might not have the resources to deeply analyze Power BI/PQ usage logs. In short, current protections are largely preventive at the network/identity level, and any detective controls are still rudimentary.\n\n## Conclusion: Raising Awareness and Next Steps\n\nThe ability to perform complex data mashups is one of Power Query's greatest strengths – but as we've seen, it also introduces a serious security concern. An insider with the know-how can leverage Power Query to bypass traditional data loss prevention, making it a potential data exfiltration pipeline if left unchecked. The current Microsoft model does not offer an out-of-the-box, foolproof block against this behavior. Instead, organizations must use a combination of network isolation, gateway enforcement, and strict tenant-level policies to mitigate the risk, and even then, gaps remain. For IT administrators and data platform owners, the key takeaway is to be aware of this blind spot. If your environment allows Power Query to run code in the cloud (as is the case with Power BI dataflows, datamarts, Excel Online, etc.), you should assume that any data accessible by those queries could potentially be sent to an external site. In high-security environments, strongly consider disabling cloud-based Power Query execution (even though it's an extreme step) or tightly constrain it to what's absolutely necessary. At the very least, implement the network isolation strategies – ensure that sensitive databases can only be reached via your controlled networks or gateways, not directly from the internet.[^33][^34]\n\nMoving forward, we can anticipate better controls from Microsoft (such as connector allowlisting and improved auditing),[^35] but until then, we have to rely on these broader security measures. Educate your teams about this risk so that power users and analysts understand why certain restrictions (like using gateways or blocking unknown connectors) might be in place. If you're a Power BI or IT admin, keep an eye on tenant settings and the roadmap for any new data exfiltration protection features. This is a nuanced security hole – it's not a traditional \"bug\" that can be patched, but rather an inherent capability being misused. Closing it completely is non-trivial, which is why awareness is crucial. By knowing the limits of current protections, you can better harden your environment and avoid unpleasant surprises. The bottom line is that data exfiltration via Power Query is possible and challenging to prevent, especially in cloud-enabled scenarios[^36] – so it's on us to be vigilant and put layers of defense around it.\n\n\n## More resources: \n* [Power BI dataflows enhanced compute engine](https://ssbipolar.com/2019/06/29/power-bi-dataflows-enhanced-compute-engine)\n* [Query evaluation in Power Query](https://learn.microsoft.com/en-us/power-query/query-folding-basics)\n* [On-premises data gateway January update is now available](https://powerbi.microsoft.com/en-us/blog/on-premises-data-gateway-january-update-is-now-available/)\n\n[^1]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Data%20exfiltration%20occurs%20when%20sensitive,or%20Power%20BI%20semantic%20models\n[^2]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=data%20across%20hundreds%20of%20supported,accidental%20or%20malicious%20data%20exfiltration\n[^3]: https://learn.microsoft.com/en-us/power-query/query-folding-basics\n[^4]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,against%20another%20untrusted%20data%20source\n[^5]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\n[^6]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\n[^7]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,and%20best%20practices%20for%20safeguards\n[^8]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\n[^9]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\n[^10]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\n[^11]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=the%20public%20internet%29,as%20firewalls%20and%20DLP%20protection\n[^12]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=access%20is%20then%20required%20to,execution%20in%20a%20cloud%20environment\n[^13]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\n[^14]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\n[^15]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\n[^16]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\n[^17]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=For%20most%20software,provided%20by%20Microsoft%20Entra%20ID\n[^18]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\n[^19]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\n[^20]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=How%20to%20use%20data%20connection,auditing\n[^21]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Shortcuts,find%20all%20connections%20by%20querying\n[^22]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Auditing%20for%20data%20source%20connections,find%20all%20connections%20by%20querying\n[^23]: https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=For%20each%20attempted%20connection%2C%20we,include%20the%20following%20information\n[^24]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\n[^25]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\n[^26]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\n[^27]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\n[^28]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,creation%2C%20updating%2C%20deletion%2C%20and%20usage\n[^29]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\n[^30]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\n[^31]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\n[^32]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\n[^33]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\n[^34]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=connections%20to%20an%20on,risks%20associated%20with%20arbitrary%20code\n[^35]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\n[^36]: https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data","src/content/blog/data-exfiltration-in-power-query.md","d54fa3b35eba4670",{"html":203,"metadata":204},"\u003Ch2 id=\"what-is-data-exfiltration-in-power-query\">What is Data Exfiltration in Power Query?\u003C/h2>\n\u003Cp>Data exfiltration is the act of moving sensitive data outside a trusted environment without authorization. In the context of Power Query (the data transformation engine behind Excel, Power BI, dataflows, etc.), this means an insider could use a Power Query script to siphon data from secure sources (like databases) out to an external destination. Microsoft defines data exfiltration as occurring when sensitive business data is accidentally or intentionally moved outside of a trusted boundary.\u003Csup>\u003Ca href=\"#user-content-fn-1\" id=\"user-content-fnref-1\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">1\u003C/a>\u003C/sup>\u003C/p>\n\u003Cp>Power Query is powerful – it can connect to hundreds of data sources and, importantly, it can make web requests. By default, when Power Query runs in cloud services (e.g. Power BI dataflows or datamarts), it executes in the Power Query Online Mashup Engine, which operates in Microsoft’s cloud with unrestricted internet access.\u003Csup>\u003Ca href=\"#user-content-fn-2\" id=\"user-content-fnref-2\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">2\u003C/a>\u003C/sup> In other words, if a user’s Power Query code is executed in the cloud, it can potentially send data to any external endpoint on the internet. This creates a potential security blind spot for organizations: a savvy user with data access can craft a query that exfiltrates (sends out) sensitive data, bypassing typical network protections.\u003C/p>\n\u003Ch2 id=\"mashup-query-engine\">Mashup Query Engine\u003C/h2>\n\u003Cp>The Mashup Engine is the core component of Power Query responsible for executing data extraction, transformation, and loading (ETL) processes. It interprets the M scripts—Power Query’s formula language—and performs the operations defined within them.\u003Csup>\u003Ca href=\"#user-content-fn-3\" id=\"user-content-fnref-3\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">3\u003C/a>\u003C/sup>\u003C/p>\n\u003Ch3 id=\"mashup-execution-environment\">Mashup Execution Environment\u003C/h3>\n\u003Cp>The Mashup Engine operates within different environments depending on where Power Query is utilized:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Desktop Applications:\u003C/strong> In tools like Excel and Power BI Desktop, the Mashup Engine runs locally on the user’s machine, leveraging local resources for data processing.\u003C/li>\n\u003Cli>\u003Cstrong>Cloud Services:\u003C/strong> In the Power BI service, the Mashup Engine executes in the cloud, utilizing Microsoft’s infrastructure to process data.\u003C/li>\n\u003Cli>\u003Cstrong>On-Premises Data Gateway:\u003C/strong> When accessing on-premises data sources from cloud services, the Mashup Engine operates through the data gateway, ensuring secure data transmission between on-premises sources and cloud services.\u003C/li>\n\u003C/ul>\n\u003Csvg aria-roledescription=\"flowchart-v2\" role=\"graphics-document document\" viewBox=\"0 0 728.09375 209\" style=\"max-width: 728.09375px;\" class=\"flowchart\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" id=\"mermaid-0\">\u003Cstyle>#mermaid-0{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-0 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-0 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-0 .error-icon{fill:#552222;}#mermaid-0 .error-text{fill:#552222;stroke:#552222;}#mermaid-0 .edge-thickness-normal{stroke-width:1px;}#mermaid-0 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-0 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-0 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-0 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-0 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-0 .marker{fill:#333333;stroke:#333333;}#mermaid-0 .marker.cross{stroke:#333333;}#mermaid-0 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-0 p{margin:0;}#mermaid-0 .label{font-family:arial,sans-serif;color:#333;}#mermaid-0 .cluster-label text{fill:#333;}#mermaid-0 .cluster-label span{color:#333;}#mermaid-0 .cluster-label span p{background-color:transparent;}#mermaid-0 .label text,#mermaid-0 span{fill:#333;color:#333;}#mermaid-0 .node rect,#mermaid-0 .node circle,#mermaid-0 .node ellipse,#mermaid-0 .node polygon,#mermaid-0 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-0 .rough-node .label text,#mermaid-0 .node .label text,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-anchor:middle;}#mermaid-0 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-0 .rough-node .label,#mermaid-0 .node .label,#mermaid-0 .image-shape .label,#mermaid-0 .icon-shape .label{text-align:center;}#mermaid-0 .node.clickable{cursor:pointer;}#mermaid-0 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-0 .arrowheadPath{fill:#333333;}#mermaid-0 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-0 .flowchart-link{stroke:#333333;fill:none;}#mermaid-0 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-0 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-0 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-0 .cluster text{fill:#333;}#mermaid-0 .cluster span{color:#333;}#mermaid-0 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-0 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-0 rect.text{fill:none;stroke-width:0;}#mermaid-0 .icon-shape,#mermaid-0 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-0 .icon-shape p,#mermaid-0 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-0 .icon-shape rect,#mermaid-0 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-0 :root{--mermaid-font-family:arial,sans-serif;}\u003C/style>\u003Cg>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointEnd\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 0 L 10 5 L 0 10 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"4.5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-pointStart\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 5 L 10 10 L 10 0 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"11\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleEnd\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"-1\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-0_flowchart-v2-circleStart\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"12\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossEnd\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"-1\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-0_flowchart-v2-crossStart\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cg class=\"root\">\u003Cg class=\"clusters\">\u003Cg data-look=\"classic\" id=\"subGraph0\" class=\"cluster\">\u003Crect height=\"186\" width=\"208\" y=\"8\" x=\"206.8515625\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(210.8515625, 8)\" class=\"cluster-label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup Execution Environment\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"edgePaths\">\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_B_0\" d=\"M81.672,111L92.878,111C104.083,111,126.495,111,148.906,111C171.318,111,193.729,111,208.435,111C223.141,111,230.141,111,233.641,111L237.141,111\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_C_0\" d=\"M351.442,84L360.462,78C369.482,72,387.522,60,410.565,54C433.607,48,461.651,48,489.035,49.869C516.419,51.738,543.143,55.477,556.505,57.346L569.867,59.215\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_B_0\" d=\"M573.828,83.951L559.806,86.626C545.784,89.301,517.74,94.65,489.695,97.325C461.651,100,433.607,100,416.08,100.407C398.554,100.814,391.545,101.628,388.04,102.035L384.536,102.442\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-0_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_D_0\" d=\"M351.442,138L360.462,144C369.482,150,387.522,162,410.565,168C433.607,174,461.651,174,492.215,174C522.779,174,555.862,174,572.404,174L588.945,174\">\u003C/path>\u003C/g>\u003Cg class=\"edgeLabels\">\u003Cg transform=\"translate(148.90625, 111)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-42.234375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"84.46875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Instructs\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 48)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-52.90625, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"105.8125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Query Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 100)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-59.1328125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"118.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(2) Returns Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(489.6953125, 174)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-51.59375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"103.1875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(3) Loads data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"nodes\">\u003Cg transform=\"translate(44.8359375, 111)\" id=\"flowchart-A-0\" class=\"node default\">\u003Ccircle cy=\"0\" cx=\"0\" r=\"36.8359375\" style=\"\" class=\"basic label-container\">\u003C/circle>\u003Cg transform=\"translate(-29.3359375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"58.671875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>M Script\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(310.8515625, 111)\" id=\"flowchart-B-1\" class=\"node default\">\u003Crect height=\"54\" width=\"139.421875\" y=\"-27\" x=\"-69.7109375\" ry=\"5\" rx=\"5\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-54.7109375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"109.421875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup engine\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(646.9609375, 70)\" id=\"flowchart-C-2\" class=\"node default\">\u003Crect height=\"54\" width=\"146.265625\" y=\"-27\" x=\"-73.1328125\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-43.1328125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"86.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Data source\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(646.9609375, 174)\" id=\"flowchart-D-3\" class=\"node default\">\u003Crect height=\"54\" width=\"108.03125\" y=\"-27\" x=\"-54.015625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-24.015625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"48.03125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Output\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/svg>\n\u003Ch2 id=\"how-can-power-query-m-code-exfiltrate-data\">How Can Power Query M Code Exfiltrate Data?\u003C/h2>\n\u003Cp>Power Query’s M language allows combining data from multiple sources and calling web endpoints and Power Query can query a secure database and then silently send that data to an external web service. Let’s illustrate with a simplified snippet of Power Query M code that demonstrates the core concept of data exfiltration:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.y0rd3.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"pq\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">let\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">// Step 1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">SourceData = Read data from a secure SQL database,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">// Step 2\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">Convert = Convert the data for transmission,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">// Step 3\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">Result = Send the data out to an external API endpoint\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">in\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#e1e4e8;--1:#24292e\">Result\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"let    // Step 1    SourceData = Read data from a secure SQL database,    // Step 2    Convert = Convert the data for transmission,    // Step 3    Result = Send the data out to an external API endpointin    Result\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cblockquote>\n\u003Cp>Figure: Simplified snippet of Power Query M code\u003C/p>\n\u003C/blockquote>\n\u003Cp>In this example, the query connects to a Secure SQL Database (e.g. an internal FinanceDB) and retrieves data. Then it converts that data and uses a function to send the data to an external web service. The \u003Ccode>Result\u003C/code> of the web call (if any) is returned by the query, but the key point is that the sensitive data has now left the organization – it’s been sent to an external server controlled by the attacker.\u003C/p>\n\u003Cp>Microsoft’s own documentation explicitly notes this risk: “By using Web.Contents, users can make web requests with sensitive data in the body of the request”.\u003Csup>\u003Ca href=\"#user-content-fn-4\" id=\"user-content-fnref-4\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">4\u003C/a>\u003C/sup>\u003C/p>\n\u003Csvg aria-roledescription=\"flowchart-v2\" role=\"graphics-document document\" viewBox=\"0 0 916.859375 369\" style=\"max-width: 916.859375px;\" class=\"flowchart\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" id=\"mermaid-1\">\u003Cstyle>#mermaid-1{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-1 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-1 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-1 .error-icon{fill:#552222;}#mermaid-1 .error-text{fill:#552222;stroke:#552222;}#mermaid-1 .edge-thickness-normal{stroke-width:1px;}#mermaid-1 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-1 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1 .marker{fill:#333333;stroke:#333333;}#mermaid-1 .marker.cross{stroke:#333333;}#mermaid-1 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-1 p{margin:0;}#mermaid-1 .label{font-family:arial,sans-serif;color:#333;}#mermaid-1 .cluster-label text{fill:#333;}#mermaid-1 .cluster-label span{color:#333;}#mermaid-1 .cluster-label span p{background-color:transparent;}#mermaid-1 .label text,#mermaid-1 span{fill:#333;color:#333;}#mermaid-1 .node rect,#mermaid-1 .node circle,#mermaid-1 .node ellipse,#mermaid-1 .node polygon,#mermaid-1 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1 .rough-node .label text,#mermaid-1 .node .label text,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-anchor:middle;}#mermaid-1 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-1 .rough-node .label,#mermaid-1 .node .label,#mermaid-1 .image-shape .label,#mermaid-1 .icon-shape .label{text-align:center;}#mermaid-1 .node.clickable{cursor:pointer;}#mermaid-1 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-1 .arrowheadPath{fill:#333333;}#mermaid-1 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-1 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-1 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-1 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-1 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1 .cluster text{fill:#333;}#mermaid-1 .cluster span{color:#333;}#mermaid-1 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-1 rect.text{fill:none;stroke-width:0;}#mermaid-1 .icon-shape,#mermaid-1 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-1 .icon-shape p,#mermaid-1 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-1 .icon-shape rect,#mermaid-1 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-1 :root{--mermaid-font-family:arial,sans-serif;}#mermaid-1 .outside>*{fill:#fdd!important;}#mermaid-1 .outside span{fill:#fdd!important;}\u003C/style>\u003Cg>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-1_flowchart-v2-pointEnd\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 0 L 10 5 L 0 10 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"4.5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-1_flowchart-v2-pointStart\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 5 L 10 10 L 10 0 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"11\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-1_flowchart-v2-circleEnd\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"-1\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-1_flowchart-v2-circleStart\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"12\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-1_flowchart-v2-crossEnd\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"-1\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-1_flowchart-v2-crossStart\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cg class=\"root\">\u003Cg class=\"clusters\">\u003Cg data-look=\"classic\" id=\"subGraph1\" class=\"cluster\">\u003Crect height=\"334\" width=\"208\" y=\"8\" x=\"206.8515625\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(210.8515625, 8)\" class=\"cluster-label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Cloud Execution Environment\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg data-look=\"classic\" id=\"subGraph0\" class=\"cluster\">\u003Crect height=\"136\" width=\"265.65625\" y=\"8\" x=\"643.203125\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(690.65625, 8)\" class=\"cluster-label\">\u003CforeignObject height=\"24\" width=\"170.75\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Corp Network Boundary\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"edgePaths\">\u003Cpath marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_B_0\" d=\"M81.672,165L92.878,165C104.083,165,126.495,165,148.906,165C171.318,165,193.729,165,208.435,165C223.141,165,230.141,165,233.641,165L237.141,165\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_C_0\" d=\"M334.976,138L346.74,124.833C358.505,111.667,382.034,85.333,413.601,72.167C445.169,59,484.776,59,524.383,59C563.99,59,603.596,59,630.812,60.172C658.027,61.344,672.85,63.687,680.262,64.859L687.674,66.031\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_B_0\" d=\"M691.625,94.615L683.555,96.013C675.484,97.41,659.344,100.205,631.47,101.603C603.596,103,563.99,103,524.383,103C484.776,103,445.169,103,417.013,108.468C388.856,113.936,372.15,124.873,363.797,130.341L355.443,135.809\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_D_0\" d=\"M373.222,192L378.612,194.333C384.002,196.667,394.782,201.333,419.976,203.667C445.169,206,484.776,206,524.383,206C563.99,206,603.596,206,630.311,206C657.026,206,670.849,206,677.76,206L684.672,206\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-1_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_B_E_0\" d=\"M327.139,192L340.21,213.667C353.28,235.333,379.421,278.667,412.295,300.333C445.169,322,484.776,322,524.383,322C563.99,322,603.596,322,626.9,322C650.203,322,657.203,322,660.703,322L664.203,322\">\u003C/path>\u003C/g>\u003Cg class=\"edgeLabels\">\u003Cg transform=\"translate(148.90625, 165)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-42.234375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"84.46875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Instructs\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(524.3828125, 59)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-52.90625, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"105.8125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Query Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(524.3828125, 103)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-93.8203125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"187.640625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(2) Returns Sensitive Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(524.3828125, 206)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-51.59375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"103.1875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(3) Loads data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(524.3828125, 322)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-56.75, -24)\" class=\"label\">\u003CforeignObject height=\"48\" width=\"113.5\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(4) HTTP POST \u003Cbr>\u003C/br>Sensitive Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"nodes\">\u003Cg transform=\"translate(44.8359375, 165)\" id=\"flowchart-A-0\" class=\"node default\">\u003Ccircle cy=\"0\" cx=\"0\" r=\"36.8359375\" style=\"\" class=\"basic label-container\">\u003C/circle>\u003Cg transform=\"translate(-29.3359375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"58.671875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>M Script\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(310.8515625, 165)\" id=\"flowchart-B-1\" class=\"node default\">\u003Crect height=\"54\" width=\"139.421875\" y=\"-27\" x=\"-69.7109375\" ry=\"5\" rx=\"5\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-54.7109375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"109.421875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup engine\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(776.03125, 80)\" id=\"flowchart-C-2\" class=\"node default\">\u003Crect height=\"54\" width=\"168.8125\" y=\"-27\" x=\"-84.40625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-54.40625, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"108.8125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>SQL Data base\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(776.03125, 206)\" id=\"flowchart-D-3\" class=\"node default\">\u003Crect height=\"54\" width=\"174.71875\" y=\"-27\" x=\"-87.359375\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-57.359375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"114.71875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Semantic Model\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(776.03125, 322)\" id=\"flowchart-E-4\" class=\"node default outside\">\u003Crect height=\"78\" width=\"215.65625\" y=\"-39\" x=\"-107.828125\" style=\"fill:#fdd !important\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-77.828125, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"155.65625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>External API Endpoint\u003Cbr>\u003C/br>attacker-controlled\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/svg>\n\u003Cblockquote>\n\u003Cp>Figure: Data Exfiltration Path via Power Query – The diagram above shows how an insider’s Power Query can extract data from a secure database and send it to an outside API, all within a single Power Query execution.\u003C/p>\n\u003C/blockquote>\n\u003Cp>In the above flow, the Power Query Mashup Engine (running in the cloud) has access to the secure SQL database (using provided credentials). It queries the data and then loads it into a semantic model \u003Cstrong>and out over the internet to an external endpoint.\u003C/strong> Notice that this exfiltration can occur even if the data source is inside the corporate network – the Mashup Engine runs outside the network by default, so it isn’t subject to the organization’s internal firewalls or DLP scanners in the usual way.\u003Csup>\u003Ca href=\"#user-content-fn-5\" id=\"user-content-fnref-5\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">5\u003C/a>\u003C/sup> Effectively, the Power Query is acting as a bridge between the secure data source and the attacker’s server.\u003C/p>\n\u003Ch2 id=\"why-is-it-hard-to-prevent-this-no-foolproof-safeguard\">Why Is It Hard to Prevent This? (No Foolproof Safeguard)\u003C/h2>\n\u003Cp>It may be startling, but there is currently no foolproof way to completely prevent data exfiltration from a Power Query file under Microsoft’s current model. If a user has access to create or edit Power Query queries (in Excel, Power BI, dataflows, etc.) and they have access to some sensitive data source, they can potentially craft M code to leak that data. The Power Query runtime will happily execute the code as long as the user is authorized to access the sources and run queries.\u003C/p>\n\u003Cp>By design, the default Power Query Online environment trusts the user’s code and has no fine-grained content inspection or egress filtering of its own. Microsoft warns that the cloud-based Mashup Engine runs outside the tenant’s network and is not subject to corporate firewalls or DLP policies, meaning data can flow to any destination the user has access to.\u003Csup>\u003Ca href=\"#user-content-fn-6\" id=\"user-content-fnref-6\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">6\u003C/a>\u003C/sup> In essence, once the query is running, the service will perform whatever data connections the code specifies – whether that’s pulling from a database or pushing to an external URL. There is no built-in setting like “disable web access in queries” or “allow queries to only connect to approved endpoints” at the Power Query level today. This is why the problem is often described as an insider threat scenario; it assumes the person executing the query is authorized to access the data in the first place, and then abuses that privilege.\u003C/p>\n\u003Cp>To reiterate, no native Power Query setting can outright stop a determined user from embedding an exfiltration step in their M code. Organizations must instead rely on broader security strategies to mitigate this risk. Microsoft’s guidance (as of early 2024) focuses on external controls – essentially making it harder for that malicious query to succeed by constraining where and how Power Query code runs. Below we’ll examine the current best practices and protections Microsoft recommends, and then why those measures still have limitations.\u003C/p>\n\u003Ch2 id=\"microsofts-recommended-protections-and-best-practices\">Microsoft’s Recommended Protections and Best Practices\u003C/h2>\n\u003Cp>Microsoft has acknowledged the data exfiltration risk in official documentation and outlines several best practices to help protect against it.\u003Csup>\u003Ca href=\"#user-content-fn-7\" id=\"user-content-fnref-7\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">7\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-8\" id=\"user-content-fnref-8\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">8\u003C/a>\u003C/sup>\u003C/p>\n\u003Cp>These protections mainly involve network-level controls and execution policies rather than application-level restrictions in Power Query itself. The key strategies include:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Network Isolation of Data Sources:\u003C/strong> Lock down your sensitive data sources so that they can only be accessed from approved network locations. For example, use firewall rules, Azure Virtual Network service endpoints, Private Links, or network security groups to ensure that the database or data source cannot be reached directly from the public Internet.\u003Csup>\u003Ca href=\"#user-content-fn-9\" id=\"user-content-fnref-9\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">9\u003C/a>\u003C/sup> The idea is to obstruct line-of-sight from the cloud-based Power Query engine to your data. If the Power Query Mashup Engine (running in the cloud) tries to connect to a protected database that isn’t reachable outside the corporate network, the connection will fail.\u003Csup>\u003Ca href=\"#user-content-fn-10\" id=\"user-content-fnref-10\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">10\u003C/a>\u003C/sup> In practice, this often means forcing the query to go through an on-premises data gateway or a VNet gateway that resides in your network. Microsoft notes that when a dataflow or query is bound to a gateway (due to the source being isolated), all data access in that query will occur via that gateway – cloud and gateway execution are never mixed in a single query.\u003Csup>\u003Ca href=\"#user-content-fn-11\" id=\"user-content-fnref-11\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">11\u003C/a>\u003C/sup> Because the gateway runs within your controlled environment, it will be subject to your organization’s firewalls, network monitoring, and DLP solutions.\u003Csup>\u003Ca href=\"#user-content-fn-12\" id=\"user-content-fnref-12\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">12\u003C/a>\u003C/sup> Essentially, network isolation + gateway enforcement makes the Power Query run as if it were on a corporate machine, where you can apply your usual outbound restrictions (for instance, blocking it from calling unknown external websites).\u003C/li>\n\u003C/ul>\n\u003Csvg aria-roledescription=\"flowchart-v2\" role=\"graphics-document document\" viewBox=\"0 0 1301.484375 514\" style=\"max-width: 1301.484375px;\" class=\"flowchart\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" id=\"mermaid-2\">\u003Cstyle>#mermaid-2{font-family:arial,sans-serif;font-size:16px;fill:#333;}@keyframes edge-animation-frame{from{stroke-dashoffset:0;}}@keyframes dash{to{stroke-dashoffset:0;}}#mermaid-2 .edge-animation-slow{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 50s linear infinite;stroke-linecap:round;}#mermaid-2 .edge-animation-fast{stroke-dasharray:9,5!important;stroke-dashoffset:900;animation:dash 20s linear infinite;stroke-linecap:round;}#mermaid-2 .error-icon{fill:#552222;}#mermaid-2 .error-text{fill:#552222;stroke:#552222;}#mermaid-2 .edge-thickness-normal{stroke-width:1px;}#mermaid-2 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-2 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-2 .edge-thickness-invisible{stroke-width:0;fill:none;}#mermaid-2 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-2 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-2 .marker{fill:#333333;stroke:#333333;}#mermaid-2 .marker.cross{stroke:#333333;}#mermaid-2 svg{font-family:arial,sans-serif;font-size:16px;}#mermaid-2 p{margin:0;}#mermaid-2 .label{font-family:arial,sans-serif;color:#333;}#mermaid-2 .cluster-label text{fill:#333;}#mermaid-2 .cluster-label span{color:#333;}#mermaid-2 .cluster-label span p{background-color:transparent;}#mermaid-2 .label text,#mermaid-2 span{fill:#333;color:#333;}#mermaid-2 .node rect,#mermaid-2 .node circle,#mermaid-2 .node ellipse,#mermaid-2 .node polygon,#mermaid-2 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-2 .rough-node .label text,#mermaid-2 .node .label text,#mermaid-2 .image-shape .label,#mermaid-2 .icon-shape .label{text-anchor:middle;}#mermaid-2 .node .katex path{fill:#000;stroke:#000;stroke-width:1px;}#mermaid-2 .rough-node .label,#mermaid-2 .node .label,#mermaid-2 .image-shape .label,#mermaid-2 .icon-shape .label{text-align:center;}#mermaid-2 .node.clickable{cursor:pointer;}#mermaid-2 .root .anchor path{fill:#333333!important;stroke-width:0;stroke:#333333;}#mermaid-2 .arrowheadPath{fill:#333333;}#mermaid-2 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-2 .flowchart-link{stroke:#333333;fill:none;}#mermaid-2 .edgeLabel{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-2 .edgeLabel p{background-color:rgba(232,232,232, 0.8);}#mermaid-2 .edgeLabel rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-2 .labelBkg{background-color:rgba(232, 232, 232, 0.5);}#mermaid-2 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-2 .cluster text{fill:#333;}#mermaid-2 .cluster span{color:#333;}#mermaid-2 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-2 .flowchartTitleText{text-anchor:middle;font-size:18px;fill:#333;}#mermaid-2 rect.text{fill:none;stroke-width:0;}#mermaid-2 .icon-shape,#mermaid-2 .image-shape{background-color:rgba(232,232,232, 0.8);text-align:center;}#mermaid-2 .icon-shape p,#mermaid-2 .image-shape p{background-color:rgba(232,232,232, 0.8);padding:2px;}#mermaid-2 .icon-shape rect,#mermaid-2 .image-shape rect{opacity:0.5;background-color:rgba(232,232,232, 0.8);fill:rgba(232,232,232, 0.8);}#mermaid-2 :root{--mermaid-font-family:arial,sans-serif;}#mermaid-2 .outside>*{fill:#fdd!important;}#mermaid-2 .outside span{fill:#fdd!important;}#mermaid-2 .disabled>*{fill:#eee!important;stroke-dasharray:5 5!important;}#mermaid-2 .disabled span{fill:#eee!important;stroke-dasharray:5 5!important;}\u003C/style>\u003Cg>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-2_flowchart-v2-pointEnd\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 0 L 10 5 L 0 10 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"8\" markerWidth=\"8\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"4.5\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-2_flowchart-v2-pointStart\">\u003Cpath style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 0 5 L 10 10 L 10 0 z\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"11\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-2_flowchart-v2-circleEnd\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5\" refX=\"-1\" viewBox=\"0 0 10 10\" class=\"marker flowchart-v2\" id=\"mermaid-2_flowchart-v2-circleStart\">\u003Ccircle style=\"stroke-width: 1; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" r=\"5\" cy=\"5\" cx=\"5\">\u003C/circle>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"12\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-2_flowchart-v2-crossEnd\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cmarker orient=\"auto\" markerHeight=\"11\" markerWidth=\"11\" markerUnits=\"userSpaceOnUse\" refY=\"5.2\" refX=\"-1\" viewBox=\"0 0 11 11\" class=\"marker cross flowchart-v2\" id=\"mermaid-2_flowchart-v2-crossStart\">\u003Cpath style=\"stroke-width: 2; stroke-dasharray: 1, 0;\" class=\"arrowMarkerPath\" d=\"M 1,1 l 9,9 M 10,1 l -9,9\">\u003C/path>\u003C/marker>\u003Cg class=\"root\">\u003Cg class=\"clusters\">\u003Cg data-look=\"classic\" id=\"subGraph1\" class=\"cluster\">\u003Crect height=\"385\" width=\"1285.484375\" y=\"8\" x=\"8\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(550.7421875, 8)\" class=\"cluster-label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Corporate Network Boundary\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg data-look=\"classic\" id=\"D\" class=\"cluster\">\u003Crect height=\"217\" width=\"585.71875\" y=\"28\" x=\"241.140625\" style=\"\">\u003C/rect>\u003Cg transform=\"translate(434, 28)\" class=\"cluster-label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Gateway Execution Environment\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"edgePaths\">\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_G_0\" d=\"M102.012,195.068L113.995,188.39C125.977,181.712,149.942,168.356,173.13,161.678C196.318,155,218.729,155,233.879,155C249.029,155,256.917,155,260.861,155L264.805,155\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_A_B_0\" d=\"M96.397,238.522L109.315,250.935C122.233,263.348,148.07,288.174,172.194,300.587C196.318,313,218.729,313,243.636,331.63C268.543,350.259,295.944,387.518,309.645,406.148L323.346,424.778\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_G_F1_0\" d=\"M422.262,128L444.465,119.167C466.667,110.333,511.072,92.667,554.535,91.108C597.998,89.549,640.52,104.098,661.781,111.372L683.041,118.647\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_F1_C_0\" d=\"M764.918,117L775.242,110C785.565,103,806.212,89,837.369,82C868.526,75,910.193,75,956.46,78.801C1002.728,82.602,1053.597,90.204,1079.031,94.006L1104.466,97.807\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_C_F1_0\" d=\"M1108.422,118.184L1082.328,122.32C1056.234,126.456,1004.047,134.728,957.12,138.864C910.193,143,868.526,143,843.027,142.711C817.527,142.423,808.195,141.846,803.529,141.557L798.863,141.269\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_F1_G_0\" d=\"M672.777,148.039L653.227,151.533C633.677,155.026,594.577,162.013,556.444,164.213C518.312,166.412,481.147,163.825,462.565,162.531L443.983,161.237\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_G_F1_2\" d=\"M439.992,139.676L459.24,136.23C478.487,132.784,516.982,125.892,556.507,124.438C596.032,122.985,636.588,126.97,656.865,128.962L677.143,130.955\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-dotted edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_F1_E_0\" d=\"M755.688,156L767.549,167.5C779.411,179,803.135,202,835.831,213.5C868.526,225,910.193,225,961.448,258.341C1012.703,291.682,1073.547,358.363,1103.968,391.704L1134.39,425.045\">\u003C/path>\u003Cpath marker-end=\"url(#mermaid-2_flowchart-v2-pointEnd)\" style=\"\" class=\"edge-thickness-normal edge-pattern-solid edge-thickness-normal edge-pattern-solid flowchart-link\" id=\"L_G_H_0\" d=\"M439.992,179.689L459.24,185.241C478.487,190.793,516.982,201.896,555.03,218.544C593.078,235.192,630.68,257.385,649.481,268.481L668.282,279.577\">\u003C/path>\u003C/g>\u003Cg class=\"edgeLabels\">\u003Cg transform=\"translate(173.90625, 155)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-42.234375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"84.46875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(1) Instructs\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(173.90625, 313)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-32.0234375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"64.046875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>Not used\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(555.4765625, 75)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-41.796875, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"83.59375\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(2) Request\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(951.859375, 75)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-47.1328125, -24)\" class=\"label\">\u003CforeignObject height=\"48\" width=\"94.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(3) Safelisted\u003Cbr>\u003C/br>Request\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(951.859375, 143)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-59.1328125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"118.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(4) Returns Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(555.4765625, 169)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-59.1328125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"118.265625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(5) Returns Data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(555.4765625, 119)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-75.59375, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"151.1875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(6) Tries to send data\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(951.859375, 225)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-100, -24)\" class=\"label\">\u003CforeignObject height=\"48\" width=\"200\">\u003Cdiv style=\"display: table; white-space: break-spaces; line-height: 1.5; max-width: 200px; text-align: center; width: 200px;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(7) ❌ Blocked by firewall rules\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(555.4765625, 213)\" class=\"edgeLabel\">\u003Cg transform=\"translate(-87.8203125, -12)\" class=\"label\">\u003CforeignObject height=\"24\" width=\"175.640625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" class=\"labelBkg\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"edgeLabel\">\u003Cp>(8) ❌ Data Load Failure\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003Cg class=\"nodes\">\u003Cg transform=\"translate(69.8359375, 213)\" id=\"flowchart-A-0\" class=\"node default\">\u003Ccircle cy=\"0\" cx=\"0\" r=\"36.8359375\" style=\"\" class=\"basic label-container\">\u003C/circle>\u003Cg transform=\"translate(-29.3359375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"58.671875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>M Script\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(354.3984375, 467)\" id=\"flowchart-B-1\" class=\"node default disabled\">\u003Crect height=\"78\" width=\"176.515625\" y=\"-39\" x=\"-88.2578125\" style=\"fill:#eee !important;stroke-dasharray:5 5 !important\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-58.2578125, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"116.515625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Cloud Execution\u003Cbr>\u003C/br>Environment\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(1172.671875, 108)\" id=\"flowchart-C-2\" class=\"node default\">\u003Crect height=\"78\" width=\"128.5\" y=\"-39\" x=\"-64.25\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-34.25, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"68.5\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Sensitive\u003Cbr>\u003C/br>Database\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(1172.671875, 467)\" id=\"flowchart-E-3\" class=\"node default outside\">\u003Crect height=\"78\" width=\"191.625\" y=\"-39\" x=\"-95.8125\" style=\"fill:#fdd !important\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-65.8125, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"131.625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>External API\u003Cbr>\u003C/br>attacker-controlled\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(735.078125, 319)\" id=\"flowchart-H-4\" class=\"node default\">\u003Crect height=\"78\" width=\"126.703125\" y=\"-39\" x=\"-63.3515625\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-33.3515625, -24)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"48\" width=\"66.703125\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Semantic\u003Cbr>\u003C/br>Model\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(354.3984375, 155)\" id=\"flowchart-G-6\" class=\"node default\">\u003Crect height=\"54\" width=\"171.1875\" y=\"-27\" x=\"-85.59375\" style=\"\" class=\"basic label-container\">\u003C/rect>\u003Cg transform=\"translate(-55.59375, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"111.1875\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>Mashup Engine\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003Cg transform=\"translate(735.078125, 136)\" id=\"flowchart-F1-7\" class=\"node default\">\u003Cpolygon transform=\"translate(-47.28125,19.5)\" class=\"label-container\" points=\"-19.5,0 114.0625,0 94.5625,-39 0,-39\">\u003C/polygon>\u003Cg transform=\"translate(-39.78125, -12)\" style=\"\" class=\"label\">\u003Crect>\u003C/rect>\u003CforeignObject height=\"24\" width=\"79.5625\">\u003Cdiv style=\"display: table-cell; white-space: nowrap; line-height: 1.5; max-width: 200px; text-align: center;\" xmlns=\"http://www.w3.org/1999/xhtml\">\u003Cspan class=\"nodeLabel\">\u003Cp>🧱 Firewall\u003C/p>\u003C/span>\u003C/div>\u003C/foreignObject>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/g>\u003C/svg>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Force On-Premises (Gateway) Execution:\u003C/strong> If truly necessary, an organization can disable cloud execution of Power Query entirely, \u003Cstrong>forcing all queries to run through on-premises gateways.\u003C/strong> Currently, Microsoft offers this as a tenant-wide policy (set via a support ticket) that turns off the Power Query Online Mashup Engine for the entire tenant.\u003Csup>\u003Ca href=\"#user-content-fn-13\" id=\"user-content-fnref-13\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">13\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-14\" id=\"user-content-fnref-14\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">14\u003C/a>\u003C/sup> After this policy is applied, any attempt at cloud evaluation will fail with an error like \u003Cem>“Cloud evaluation request denied based on tenant policies. Please use a data gateway and try again.”\u003C/em>\u003Csup>\u003Ca href=\"#user-content-fn-15\" id=\"user-content-fnref-15\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">15\u003C/a>\u003C/sup> This effectively guarantees that none of your Power Query code runs in Microsoft’s cloud environment – everything has to go through a gateway that you control. However, this is a very blunt measure: it’s all or nothing (more on the drawbacks later). Microsoft notes that this policy impacts all dataflow-like operations (Power BI dataflows, Fabric dataflows, Power Platform dataflows, datamarts, etc.), and it is applied tenant-wide, not to specific workspaces or users.\u003Csup>\u003Ca href=\"#user-content-fn-16\" id=\"user-content-fnref-16\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">16\u003C/a>\u003C/sup> In other words, you can’t selectively allow some cloud executions and block others with this policy; turning it on will break any queries that were not already using a gateway, until they are reconfigured.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Tenant and Identity Policies:\u003C/strong> Another aspect of Microsoft’s guidance is to use identity-driven controls to prevent data from leaving the organization’s tenant or being accessed by unauthorized users. For cloud SaaS data stores (like Dataverse, Fabric Lakehouse, or even Power BI itself as a data source), pure network isolation might not be feasible because these services have multi-tenant endpoints. Instead, Microsoft recommends tenant isolation policies at the Azure AD (Entra ID) level.\u003Csup>\u003Ca href=\"#user-content-fn-17\" id=\"user-content-fnref-17\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">17\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-18\" id=\"user-content-fnref-18\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">18\u003C/a>\u003C/sup> Examples include: only allow authentication via your organization’s Azure AD (no using generic usernames/passwords or anonymous access to data sources), enforce location-based conditional access so that only users on managed devices (e.g. corporate laptops or network) can access the Power BI/Fabric service, and use tenant restrictions to block your users from signing into other tenants’ Power BI environments (and vice versa).\u003Csup>\u003Ca href=\"#user-content-fn-19\" id=\"user-content-fnref-19\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">19\u003C/a>\u003C/sup> These measures help ensure that a user can’t, say, use their credentials on an external Power BI tenant or tool to pull data out, and that only approved devices within your org can run queries. While these identity-centric controls don’t directly stop something like \u003Ccode>Web.Contents\u003C/code> calls, they do guard against certain exfiltration paths (such as an employee trying to shuttle data to another cloud tenant or personal account).\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Governance and Monitoring:\u003C/strong> In addition to preventive controls, Microsoft is adding auditing and governance features to address this gap. Administrators can leverage Power BI/Fabric audit logs (via Microsoft Purview) to monitor data connection activities.\u003Csup>\u003Ca href=\"#user-content-fn-20\" id=\"user-content-fnref-20\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">20\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-21\" id=\"user-content-fnref-21\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">21\u003C/a>\u003C/sup> Every time a Power Query data source connection is created or used, it can be logged with details like who ran it, what data source was accessed, and whether a gateway was involved.\u003Csup>\u003Ca href=\"#user-content-fn-22\" id=\"user-content-fnref-22\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">22\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-23\" id=\"user-content-fnref-23\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">23\u003C/a>\u003C/sup> This doesn’t stop an exfiltration attempt in real-time, but it provides a trail that could identify suspicious behavior (for example, a user suddenly using a Web data source or an unknown API in their query). Microsoft’s roadmap also includes features like data source allowlisting – which will let tenant admins restrict what connectors or endpoints can be used in Power Query – and enhanced auditing of query activities.\u003Csup>\u003Ca href=\"#user-content-fn-24\" id=\"user-content-fnref-24\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">24\u003C/a>\u003C/sup> These are not yet fully available as of this writing, but they indicate that finer-grained controls are on the way.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>In summary, Microsoft’s current best practices to mitigate Power Query exfiltration risks involve shifting execution into controlled environments (gateways or isolated networks), and layering on network/identity policies and monitoring. All of these assume the organization takes explicit action to constrain how Power Query runs. If you do nothing, the default is that the Power Query Online engine will run your code in the cloud with open internet access – a scenario in which an insider could potentially send data anywhere.\u003Csup>\u003Ca href=\"#user-content-fn-25\" id=\"user-content-fnref-25\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">25\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-26\" id=\"user-content-fnref-26\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">26\u003C/a>\u003C/sup>\u003C/p>\n\u003Ch2 id=\"limitations-and-shortcomings-of-the-current-approach\">Limitations and Shortcomings of the Current Approach\u003C/h2>\n\u003Cp>While the above measures can reduce the risk, they come with significant limitations. It’s important to understand these shortcomings:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Heavy Reliance on Network Layer Security:\u003C/strong> The primary defense is essentially “don’t let the cloud engine talk to anything it shouldn’t” by using network isolation. This puts a lot of onus on infrastructure setup – every sensitive data source must be properly firewalled or put behind private networks. Any gap (for instance, a database that allows public IP access or an allowed outbound route to the internet) can be exploited by a malicious query. Microsoft explicitly notes that higher-layer controls like app-level policies or conditional access are not sufficient; you really need network-level or lower isolation for sensitive data.\u003Csup>\u003Ca href=\"#user-content-fn-27\" id=\"user-content-fnref-27\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">27\u003C/a>\u003C/sup> Not every organization is prepared to enforce strict network rules for all data sources, and doing so can be complex and costly (especially if you have many data systems). In short, the current model leans on traditional network security – if that’s not airtight, Power Query can punch through it.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>No Fine-Grained Power Query Controls:\u003C/strong> Today, there is a lack of fine-grained controls within Power Query itself. If you allow people to author queries, you are inherently allowing them to use the full M language power. There’s no built-in way to say “user X’s queries cannot call Web.Contents” or “only allow queries to connect to domain Y” in the Power BI or Excel UI. The platform doesn’t let an admin easily restrict specific functions or external calls on a per-file or per-workspace basis. The all-or-nothing tenant policy to disable cloud execution is basically the only switch, and it doesn’t discriminate between “good” and “bad” queries. Microsoft has recognized this gap – hence the planned feature to allowlist or block specific connectors/endpoints.\u003Csup>\u003Ca href=\"#user-content-fn-28\" id=\"user-content-fnref-28\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">28\u003C/a>\u003C/sup> – but until that arrives, organizations have limited options. This means a determined insider with edit rights can use any connector or function at their disposal in M. Even if you only give someone access to one data source, they could still combine it with a Web connector in the query to send data out. There is also no content inspection of the M script by the service that could catch something like “hey, this query is posting data to an unknown URL” – it will just execute it.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Tenant-Level “Kill Switch” is All or Nothing:\u003C/strong> The strongest preventive measure available – turning off the cloud Mashup Engine – applies to the entire tenant and all Power Query workloads.\u003Csup>\u003Ca href=\"#user-content-fn-29\" id=\"user-content-fnref-29\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">29\u003C/a>\u003C/sup> This is a very coarse control. In a large organization, completely forcing gateway execution can be disruptive: all dataflows, datamarts, and even certain Power BI features (like Quick Import from SharePoint or some transformations) will stop running in the cloud and require a gateway or will break.\u003Csup>\u003Ca href=\"#user-content-fn-30\" id=\"user-content-fnref-30\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">30\u003C/a>\u003C/sup> There’s no way to enforce the restriction for only a subset of workspaces or only for certain users. It’s also not a toggle you can self-serve in the admin portal as of now – it requires filing a support ticket to get it enabled.\u003Csup>\u003Ca href=\"#user-content-fn-31\" id=\"user-content-fnref-31\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">31\u003C/a>\u003C/sup> Because it’s tenant-wide, if you enable it, you need to have gateways set up for every scenario, and sufficient capacity on those gateways to handle the load.\u003Csup>\u003Ca href=\"#user-content-fn-32\" id=\"user-content-fnref-32\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">32\u003C/a>\u003C/sup> This heavy-handed approach might be unacceptable for organizations that rely on cloud dataflows for convenience or have many existing cloud refreshes. In practice, many companies hesitate to use this nuclear option, leaving them to rely on the network and policy approaches above – which, as noted, are not foolproof.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Insider Threat Still Exists:\u003C/strong> Even with all the controls, remember that these measures primarily make it harder (or more detectable) to exfiltrate data – they don’t eliminate the possibility entirely. For example, if an organization allows Power Query to run in the cloud for convenience, and just trusts network isolation, a savvy insider might still find an endpoint that is allowed. Or if an on-premises gateway is used, but that gateway machine itself has unrestricted internet access, the query’s \u003Ccode>Web.Contents\u003C/code> call could run through the gateway and out to the internet (unless the gateway’s environment is locked down by network rules). Identity policies (like tenant restrictions or managed device requirements) help prevent certain routes of exfiltration (such as using an external tenant or unmanaged PC), but they don’t stop a query from sending data to an anonymous external API from within an allowed session. Ultimately, an authorized user abusing their data access via Power Query is difficult to stop without either removing their access or implementing very restrictive infrastructure controls.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Lack of Visibility and Granular Auditing:\u003C/strong> Although auditing capabilities are improving, it can still be non-trivial to spot what exactly a query is doing. The audit logs will tell you that a data source was accessed or maybe that a Web data source was used, but they won’t necessarily flag “this query sent 500 customer records to example.com.” There’s no content inspection of the payload in logs. So detection of malicious use might require correlating logs (e.g. noticing that right after someone accessed a sensitive SQL data source, they also made a series of web calls). This is more of a SOC (Security Operations) challenge – and many orgs might not have the resources to deeply analyze Power BI/PQ usage logs. In short, current protections are largely preventive at the network/identity level, and any detective controls are still rudimentary.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"conclusion-raising-awareness-and-next-steps\">Conclusion: Raising Awareness and Next Steps\u003C/h2>\n\u003Cp>The ability to perform complex data mashups is one of Power Query’s greatest strengths – but as we’ve seen, it also introduces a serious security concern. An insider with the know-how can leverage Power Query to bypass traditional data loss prevention, making it a potential data exfiltration pipeline if left unchecked. The current Microsoft model does not offer an out-of-the-box, foolproof block against this behavior. Instead, organizations must use a combination of network isolation, gateway enforcement, and strict tenant-level policies to mitigate the risk, and even then, gaps remain. For IT administrators and data platform owners, the key takeaway is to be aware of this blind spot. If your environment allows Power Query to run code in the cloud (as is the case with Power BI dataflows, datamarts, Excel Online, etc.), you should assume that any data accessible by those queries could potentially be sent to an external site. In high-security environments, strongly consider disabling cloud-based Power Query execution (even though it’s an extreme step) or tightly constrain it to what’s absolutely necessary. At the very least, implement the network isolation strategies – ensure that sensitive databases can only be reached via your controlled networks or gateways, not directly from the internet.\u003Csup>\u003Ca href=\"#user-content-fn-33\" id=\"user-content-fnref-33\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">33\u003C/a>\u003C/sup>\u003Csup>\u003Ca href=\"#user-content-fn-34\" id=\"user-content-fnref-34\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">34\u003C/a>\u003C/sup>\u003C/p>\n\u003Cp>Moving forward, we can anticipate better controls from Microsoft (such as connector allowlisting and improved auditing),\u003Csup>\u003Ca href=\"#user-content-fn-35\" id=\"user-content-fnref-35\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">35\u003C/a>\u003C/sup> but until then, we have to rely on these broader security measures. Educate your teams about this risk so that power users and analysts understand why certain restrictions (like using gateways or blocking unknown connectors) might be in place. If you’re a Power BI or IT admin, keep an eye on tenant settings and the roadmap for any new data exfiltration protection features. This is a nuanced security hole – it’s not a traditional “bug” that can be patched, but rather an inherent capability being misused. Closing it completely is non-trivial, which is why awareness is crucial. By knowing the limits of current protections, you can better harden your environment and avoid unpleasant surprises. The bottom line is that data exfiltration via Power Query is possible and challenging to prevent, especially in cloud-enabled scenarios\u003Csup>\u003Ca href=\"#user-content-fn-36\" id=\"user-content-fnref-36\" data-footnote-ref=\"\" aria-describedby=\"footnote-label\">36\u003C/a>\u003C/sup> – so it’s on us to be vigilant and put layers of defense around it.\u003C/p>\n\u003Ch2 id=\"more-resources\">More resources:\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://ssbipolar.com/2019/06/29/power-bi-dataflows-enhanced-compute-engine\">Power BI dataflows enhanced compute engine\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/query-folding-basics\">Query evaluation in Power Query\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://powerbi.microsoft.com/en-us/blog/on-premises-data-gateway-january-update-is-now-available/\">On-premises data gateway January update is now available\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Csection data-footnotes=\"\" class=\"footnotes\">\u003Ch2 class=\"sr-only\" id=\"footnote-label\">Footnotes\u003C/h2>\n\u003Col>\n\u003Cli id=\"user-content-fn-1\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Data%20exfiltration%20occurs%20when%20sensitive,or%20Power%20BI%20semantic%20models\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Data%20exfiltration%20occurs%20when%20sensitive,or%20Power%20BI%20semantic%20models\u003C/a> \u003Ca href=\"#user-content-fnref-1\" data-footnote-backref=\"\" aria-label=\"Back to reference 1\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-2\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=data%20across%20hundreds%20of%20supported,accidental%20or%20malicious%20data%20exfiltration\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=data%20across%20hundreds%20of%20supported,accidental%20or%20malicious%20data%20exfiltration\u003C/a> \u003Ca href=\"#user-content-fnref-2\" data-footnote-backref=\"\" aria-label=\"Back to reference 2\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-3\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/query-folding-basics\">https://learn.microsoft.com/en-us/power-query/query-folding-basics\u003C/a> \u003Ca href=\"#user-content-fnref-3\" data-footnote-backref=\"\" aria-label=\"Back to reference 3\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-4\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,against%20another%20untrusted%20data%20source\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,against%20another%20untrusted%20data%20source\u003C/a> \u003Ca href=\"#user-content-fnref-4\" data-footnote-backref=\"\" aria-label=\"Back to reference 4\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-5\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\u003C/a> \u003Ca href=\"#user-content-fnref-5\" data-footnote-backref=\"\" aria-label=\"Back to reference 5\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-6\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\u003C/a> \u003Ca href=\"#user-content-fnref-6\" data-footnote-backref=\"\" aria-label=\"Back to reference 6\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-7\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,and%20best%20practices%20for%20safeguards\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,and%20best%20practices%20for%20safeguards\u003C/a> \u003Ca href=\"#user-content-fnref-7\" data-footnote-backref=\"\" aria-label=\"Back to reference 7\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-8\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\u003C/a> \u003Ca href=\"#user-content-fnref-8\" data-footnote-backref=\"\" aria-label=\"Back to reference 8\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-9\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\u003C/a> \u003Ca href=\"#user-content-fnref-9\" data-footnote-backref=\"\" aria-label=\"Back to reference 9\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-10\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\u003C/a> \u003Ca href=\"#user-content-fnref-10\" data-footnote-backref=\"\" aria-label=\"Back to reference 10\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-11\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=the%20public%20internet%29,as%20firewalls%20and%20DLP%20protection\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=the%20public%20internet%29,as%20firewalls%20and%20DLP%20protection\u003C/a> \u003Ca href=\"#user-content-fnref-11\" data-footnote-backref=\"\" aria-label=\"Back to reference 11\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-12\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=access%20is%20then%20required%20to,execution%20in%20a%20cloud%20environment\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=access%20is%20then%20required%20to,execution%20in%20a%20cloud%20environment\u003C/a> \u003Ca href=\"#user-content-fnref-12\" data-footnote-backref=\"\" aria-label=\"Back to reference 12\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-13\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\u003C/a> \u003Ca href=\"#user-content-fnref-13\" data-footnote-backref=\"\" aria-label=\"Back to reference 13\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-14\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-14\" data-footnote-backref=\"\" aria-label=\"Back to reference 14\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-15\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-15\" data-footnote-backref=\"\" aria-label=\"Back to reference 15\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-16\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-16\" data-footnote-backref=\"\" aria-label=\"Back to reference 16\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-17\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=For%20most%20software,provided%20by%20Microsoft%20Entra%20ID\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=For%20most%20software,provided%20by%20Microsoft%20Entra%20ID\u003C/a> \u003Ca href=\"#user-content-fnref-17\" data-footnote-backref=\"\" aria-label=\"Back to reference 17\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-18\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\u003C/a> \u003Ca href=\"#user-content-fnref-18\" data-footnote-backref=\"\" aria-label=\"Back to reference 18\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-19\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,14\u003C/a> \u003Ca href=\"#user-content-fnref-19\" data-footnote-backref=\"\" aria-label=\"Back to reference 19\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-20\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=How%20to%20use%20data%20connection,auditing\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=How%20to%20use%20data%20connection,auditing\u003C/a> \u003Ca href=\"#user-content-fnref-20\" data-footnote-backref=\"\" aria-label=\"Back to reference 20\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-21\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Shortcuts,find%20all%20connections%20by%20querying\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Shortcuts,find%20all%20connections%20by%20querying\u003C/a> \u003Ca href=\"#user-content-fnref-21\" data-footnote-backref=\"\" aria-label=\"Back to reference 21\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-22\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Auditing%20for%20data%20source%20connections,find%20all%20connections%20by%20querying\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=Auditing%20for%20data%20source%20connections,find%20all%20connections%20by%20querying\u003C/a> \u003Ca href=\"#user-content-fnref-22\" data-footnote-backref=\"\" aria-label=\"Back to reference 22\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-23\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=For%20each%20attempted%20connection%2C%20we,include%20the%20following%20information\">https://learn.microsoft.com/en-us/data-integration/gateway/data-connection-auditing#:~:text=For%20each%20attempted%20connection%2C%20we,include%20the%20following%20information\u003C/a> \u003Ca href=\"#user-content-fnref-23\" data-footnote-backref=\"\" aria-label=\"Back to reference 23\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-24\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\u003C/a> \u003Ca href=\"#user-content-fnref-24\" data-footnote-backref=\"\" aria-label=\"Back to reference 24\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-25\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=unrestricted%20internet%20access,to%20flow%20between%20these%20sources\u003C/a> \u003Ca href=\"#user-content-fnref-25\" data-footnote-backref=\"\" aria-label=\"Back to reference 25\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-26\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\u003C/a> \u003Ca href=\"#user-content-fnref-26\" data-footnote-backref=\"\" aria-label=\"Back to reference 26\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-27\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=We%20recommend%20that%20all%20data,considered%20insufficient%20for%20this%20purpose\u003C/a> \u003Ca href=\"#user-content-fnref-27\" data-footnote-backref=\"\" aria-label=\"Back to reference 27\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-28\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,creation%2C%20updating%2C%20deletion%2C%20and%20usage\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=,creation%2C%20updating%2C%20deletion%2C%20and%20usage\u003C/a> \u003Ca href=\"#user-content-fnref-28\" data-footnote-backref=\"\" aria-label=\"Back to reference 28\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-29\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-29\" data-footnote-backref=\"\" aria-label=\"Back to reference 29\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-30\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=After%20application%20of%20the%20policy%2C,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-30\" data-footnote-backref=\"\" aria-label=\"Back to reference 30\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-31\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20goal%20for%20isolating%20sensitive,Impacted%20capabilities%20include\u003C/a> \u003Ca href=\"#user-content-fnref-31\" data-footnote-backref=\"\" aria-label=\"Back to reference 31\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-32\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=a%20full%20network%20isolation%20solution,to%20accommodate%20all%20their%20workloads\u003C/a> \u003Ca href=\"#user-content-fnref-32\" data-footnote-backref=\"\" aria-label=\"Back to reference 32\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-33\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=These%20network%20isolation%20policies%20must,Additionally%2C%20since\u003C/a> \u003Ca href=\"#user-content-fnref-33\" data-footnote-backref=\"\" aria-label=\"Back to reference 33\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-34\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=connections%20to%20an%20on,risks%20associated%20with%20arbitrary%20code\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=connections%20to%20an%20on,risks%20associated%20with%20arbitrary%20code\u003C/a> \u003Ca href=\"#user-content-fnref-34\" data-footnote-backref=\"\" aria-label=\"Back to reference 34\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-35\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=The%20following%20list%20contains%20some,data%20exfiltration%20risks%20in%20Fabric\u003C/a> \u003Ca href=\"#user-content-fnref-35\" data-footnote-backref=\"\" aria-label=\"Back to reference 35\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli id=\"user-content-fn-36\">\n\u003Cp>\u003Ca href=\"https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\">https://learn.microsoft.com/en-us/power-query/dataflows/data-exfiltration-best-practices#:~:text=A%20trusted%20user%20who%20has,programs%20can%20exfiltrate%20sensitive%20data\u003C/a> \u003Ca href=\"#user-content-fnref-36\" data-footnote-backref=\"\" aria-label=\"Back to reference 36\" class=\"data-footnote-backref\">↩\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003C/section>",{"headings":205,"localImagePaths":236,"remoteImagePaths":237,"frontmatter":238,"imagePaths":243},[206,209,212,215,218,221,224,227,230,233],{"depth":91,"slug":207,"text":208},"what-is-data-exfiltration-in-power-query","What is Data Exfiltration in Power Query?",{"depth":91,"slug":210,"text":211},"mashup-query-engine","Mashup Query Engine",{"depth":95,"slug":213,"text":214},"mashup-execution-environment","Mashup Execution Environment",{"depth":91,"slug":216,"text":217},"how-can-power-query-m-code-exfiltrate-data","How Can Power Query M Code Exfiltrate Data?",{"depth":91,"slug":219,"text":220},"why-is-it-hard-to-prevent-this-no-foolproof-safeguard","Why Is It Hard to Prevent This? (No Foolproof Safeguard)",{"depth":91,"slug":222,"text":223},"microsofts-recommended-protections-and-best-practices","Microsoft’s Recommended Protections and Best Practices",{"depth":91,"slug":225,"text":226},"limitations-and-shortcomings-of-the-current-approach","Limitations and Shortcomings of the Current Approach",{"depth":91,"slug":228,"text":229},"conclusion-raising-awareness-and-next-steps","Conclusion: Raising Awareness and Next Steps",{"depth":91,"slug":231,"text":232},"more-resources","More resources:",{"depth":91,"slug":234,"text":235},"footnote-label","Footnotes",[],[],{"title":187,"pubDate":239,"slug":184,"featured":18,"draft":18,"tags":240,"description":188,"author":241,"reviewedBy":242},["Date","2025-04-21T00:00:00.000Z"],[191,192],{"name":194,"link":195},{"name":197,"link":198},[],"data-exfiltration-in-power-query.md"]